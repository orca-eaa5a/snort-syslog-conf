alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Java ClassLoader access attempt"; flow:to_server,established; content:"class["; nocase; http_uri; content:"ClassLoader"; distance:0; fast_pattern; nocase; http_uri; pcre:"/class(\x5b\s*?[\x22\x27]module[\x22\x27]\s*?\x5d)?\x5b\s*?[\x22\x27]ClassLoader[\x22\x27]\s*?\x5d/Ui"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2014-0112; reference:cve,2022-22965; reference:url,cwiki.apache.org/confluence/display/WW/S2-021; reference:url,tanzu.vmware.com/security/cve-2022-22965;  sid:30793; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Java ClassLoader access attempt"; flow:to_server,established; content:"ClassLoader"; fast_pattern:only; http_uri; pcre:"/class\x2e(module\x2e)?ClassLoader\x2e[^&]+?=/Ui"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,65999; reference:cve,2014-0094; reference:cve,2014-0114; reference:cve,2022-22965; reference:url,struts.apache.org/release/2.3.x/docs/s2-020.html; reference:url,tanzu.vmware.com/security/cve-2022-22965;  sid:30792; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Java ClassLoader access attempt"; flow:to_server,established; content:"class"; nocase; http_client_body; content:"ClassLoader"; distance:0; nocase; http_client_body; pcre:"/class((\x5b|%5b)\s*?([\x22\x27]|%22|%27)module([\x22\x27]|%22|%27)\s*?(\x5d|%5d))?(\x5b|%5b)\s*?([\x22\x27]|%22|%27)ClassLoader([\x22\x27]|%22|%27)\s*?(\x5d|%5d)/Pi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2014-0112; reference:cve,2022-22965; reference:url,cwiki.apache.org/confluence/display/WW/S2-021; reference:url,tanzu.vmware.com/security/cve-2022-22965;  sid:30791; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Java ClassLoader access attempt"; flow:to_server,established; content:"class"; nocase; http_client_body; content:"ClassLoader"; distance:0; nocase; http_client_body; pcre:"/class(\x2e|%2e)(module(\x2e|%2e))?ClassLoader(\x2e|%2e)/Pi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,65999; reference:cve,2014-0094; reference:cve,2014-0114; reference:cve,2022-22965; reference:url,struts.apache.org/release/2.3.x/docs/s2-020.html; reference:url,tanzu.vmware.com/security/cve-2022-22965;  sid:30790; rev:8;)

alert tcp $EXTERNAL_NET any -> $HOME_NET [1099,6099,7001,$HTTP_PORTS] (msg:"SERVER-WEBAPP Java Library UniversalExtractor unauthorized deserialization attempt"; flow:to_server,established; content:"|AC ED 00 05|"; content:"com.tangosol.util.extractor.UniversalExtractor"; distance:0; content:"Lysoserial"; distance:0; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service java_rmi; reference:cve,2020-14625; reference:url,github.com/frohoff/ysoserial;  sid:56445; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP phpinfo function cross site scripting attempt"; flow:to_server,established; content:"[]=<<"; fast_pattern; http_client_body; content:"# alert("; within:100; http_client_body; content:".php"; http_uri; content:"Host: 1"; http_header; metadata:policy max-detect-ips drop, service http;  sid:51139; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP phpinfo function cross site scripting attempt"; flow:to_server,established; content:"[]=<<"; fast_pattern:only; http_uri; content:"/?"; depth:2; http_uri; content:"# alert("; http_uri; urilen:>20; content:"Accept: */*|0D 0A|Connection: keep-alive"; metadata:policy max-detect-ips drop, service http;  sid:51138; rev:1;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP ProjectPier remote file include attempt"; flow:to_server,established; content:"/public/patch/patch.php"; fast_pattern:only; http_uri; content:"id="; nocase; http_uri; content:"|3A|/"; http_uri; pcre:"/[?&]id=[^&]*?(http|ftp)/Ui"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-10759;  sid:50996; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP ProjectPier remote file include attempt"; flow:to_server,established; content:"/public/patch/patch.php"; fast_pattern:only; http_uri; content:"id="; nocase; http_client_body; pcre:"/(^|&)id=[^&]*?(http|ftp)/Pim"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-10759;  sid:50995; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP ProjectPier remote file include attempt"; flow:to_server,established; content:"/public/patch/patch.php"; fast_pattern:only; http_uri; content:"id="; nocase; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2018-10759;  sid:50994; rev:1;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP generic cross site scripting via url attempt"; flow:to_server,established; content:"<IMG SRC="; nocase; http_uri; content:"javascript:# alert("; within:20; nocase; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,www.owasp.org/index.php/Script_in_IMG_tags;  sid:49920; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP generic session fixation attempt"; flow:to_server,established; content:"<meta http-equiv=Set-Cookie content="; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,www.owasp.org/index.php/Session_fixation;  sid:49919; rev:1;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Superset python pickle library remote code execution attempt"; flow:to_server,established; content:"/superset/import_dashboards"; fast_pattern:only; http_uri; content:"cposix|0A|"; http_client_body; content:"|0A 28|S'"; within:25; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-8021;  sid:48551; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Superset python pickle library remote code execution attempt"; flow:to_server,established; content:"/superset/import_dashboards"; fast_pattern:only; http_uri; content:"csubprocess|0A|"; http_client_body; content:"|0A 28|S'"; within:25; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-8021;  sid:48550; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Superset python pickle library remote code execution attempt"; flow:to_server,established; content:"/superset/import_dashboards"; fast_pattern:only; http_uri; content:"cos|0A|"; http_client_body; content:"|0A 28|S'"; within:25; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-8021;  sid:48549; rev:1;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Struts remote code execution attempt"; flow:to_server; content:"|23|_memberAccess"; fast_pattern:only; http_uri; content:"ognl."; http_uri; pcre:"/ognl\x2e(OgnlContext|ClassResolver|TypeConverter|MemberAccess)/Ui"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-11776; reference:url,cwiki.apache.org/confluence/display/WW/S2-057;  sid:47649; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-WEBAPP Oracle WebLogic Server arbitrary JSP file upload attempt"; flow:to_server,established; content:"/ws_utc/begin.do"; fast_pattern:only; http_uri; content:"<%"; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,104763; reference:cve,2018-2894; reference:url,www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html;  sid:47390; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-WEBAPP Oracle WebLogic Server arbitrary JSP file upload attempt"; flow:to_server,established; content:"/ws_utc/config.do"; fast_pattern:only; http_uri; content:"<%"; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,104763; reference:cve,2018-2894; reference:url,www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html;  sid:47389; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-WEBAPP Oracle WebLogic Server potential precursor to keystore attack attempt"; flow:to_server,established; content:"/ws_utc/resources/setting/keystore"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:bugtraq,104763; reference:cve,2018-2894; reference:url,www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html;  sid:47388; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-WEBAPP Oracle WebLogic Server potential unauthenticated reconnaissance attempt"; flow:to_server,established; content:"/ws_utc/resources/setting/options/general"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:bugtraq,104763; reference:cve,2018-2894; reference:url,www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html;  sid:47387; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-WEBAPP Oracle WebLogic Server unauthenticated modified JSP access attempt"; flow:to_server,established; content:"/ws_utc/css/config/keystore/"; fast_pattern:only; http_uri; content:".jsp"; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:bugtraq,104763; reference:cve,2018-2894; reference:url,www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html;  sid:47386; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP phar extension remote code execution attempt"; flow:to_server,established; file_data; content:"|00 01 00 00 00 FF FF 00 00 01 00 00 00 00 00 00 00 00 00 FE FF FF FF 65 78 61 6D 70 6C 65 2E 70 68 70 1E 00 00 00 23 57|"; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, service http; reference:cve,2016-4072; reference:url,bugs.php.net/bug.php?id=71860; reference:url,php.net/ChangeLog-7.php;  sid:47207; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $FILE_DATA_PORTS (msg:"SERVER-WEBAPP PHP unserialize integer overflow attempt"; flow:to_server,established; content:"o:"; depth:10; http_client_body; content:"|3B|a:"; http_client_body; content:!":{"; within:9; http_client_body; content:":{"; within:35; distance:10; http_client_body; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,95371; reference:cve,2017-5340;  sid:47156; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $FILE_DATA_PORTS (msg:"SERVER-WEBAPP PHP unserialize integer overflow attempt"; flow:to_server,established; content:"o:"; depth:10; http_client_body; content:"|3B|d:"; http_client_body; content:!"."; within:20; http_client_body; content:"|3B|"; within:20; distance:20; http_client_body; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,95371; reference:cve,2017-5340;  sid:47155; rev:1;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP phpMyAdmin preg_replace null byte injection attempt"; flow:to_server,established; content:"/tbl_find_replace.php"; fast_pattern:only; http_uri; content:"replaceWith="; nocase; content:"find="; nocase; http_uri; pcre:"/[?&]find=[^&]*?\x00/Ui"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-5734; reference:url,www.phpmyadmin.net/security/PMASA-2016-27/;  sid:47046; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP phpMyAdmin preg_replace null byte injection attempt"; flow:to_server,established; content:"/tbl_find_replace.php"; fast_pattern:only; http_uri; content:"replaceWith="; nocase; content:"find="; nocase; http_client_body; pcre:"/(^|&)find=[^&]*?(%00|\x00)/Pim"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-5734; reference:url,www.phpmyadmin.net/security/PMASA-2016-27/;  sid:47045; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,9200] (msg:"SERVER-WEBAPP Elasticsearch directory traversal attempt"; flow:to_server,established; content:"GET /_plugin/head/"; content:"../"; within:25; metadata:policy max-detect-ips drop, service http; reference:cve,2015-3337;  sid:46881; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Spring Security OAuth remote code execution attempt"; flow:to_server,established; content:"/oauth/authorize"; fast_pattern:only; http_uri; content:"${"; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-1260;  sid:46823; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP .phar cross site scripting attempt"; flow:to_server,established; content:".phar/"; fast_pattern:only; http_uri; pcre:"/\x2ephar\x2f[^&]*?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/Ui"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,102742; reference:bugtraq,104020; reference:cve,2018-10547; reference:cve,2018-5712;  sid:46808; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP WebPort 1.16.2 directory traversal attempt"; flow:to_server,established; content:"/file/download"; fast_pattern:only; http_uri; content:"file"; nocase; http_client_body; content:"Content-Disposition"; nocase; http_client_body; pcre:"/name\s*=\s*[\x22\x27]?file((?!^--).)*?\x2e\x2e[\x2f\x5c]/Psim"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,webport.se;  sid:46522; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP WebPort 1.16.2 directory traversal attempt"; flow:to_server,established; content:"/file/download"; fast_pattern:only; http_uri; content:"file="; nocase; http_client_body; pcre:"/(^|&)file=[^&]*?(\x2e|%2e){2}([\x2f\x5c]|%2f|%5c)/Pim"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,webport.se;  sid:46521; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP WebPort 1.16.2 directory traversal attempt"; flow:to_server,established; content:"/file/download"; fast_pattern:only; http_uri; content:"file="; nocase; http_uri; content:"../"; http_uri; pcre:"/[?&]file=[^&]*?\x2e\x2e\x2f/Ui"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,webport.se;  sid:46520; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $FILE_DATA_PORTS (msg:"SERVER-WEBAPP PHP unserialize integer overflow attempt"; flow:to_client,established; file_data; content:"o:"; depth:10; content:"|3B|d:"; content:!"."; within:20; content:"|3B|"; within:20; distance:20; pcre:"/\x3bd\x3a\d{20,}?\x3b/"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,95371; reference:cve,2017-5340;  sid:46470; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SERVER-WEBAPP PHP unserialize integer overflow attempt"; flow:to_server,established; file_data; content:"o:"; depth:10; content:"|3B|d:"; content:!"."; within:20; content:"|3B|"; within:20; distance:20; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,95371; reference:cve,2017-5340;  sid:46469; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Jetspeed PageManagementService persistent XSS attempt"; flow:to_server,established; content:"/jetspeed/services/pagemanagement/info/.psml/_user/"; fast_pattern:only; http_uri; content:"title="; nocase; http_uri; pcre:"/[?&]title=[^&]*?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/Ui"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-0711;  sid:46328; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,3000] (msg:"SERVER-WEBAPP ZEIT Next.js /_next namespace directory traversal attempt"; flow:to_server,established; content:"GET /_next"; content:"../"; within:50; content:"HTTP/"; within:100; metadata:policy max-detect-ips drop, service http; reference:cve,2018-6184; reference:url,github.com/zeit/next.js;  sid:45959; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHPMailer command injection remote code execution attempt"; flow:to_server,established; content:"Host: "; http_header; content:" -be ${run{"; within:100; http_header; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2016-10033; reference:cve,2016-10034; reference:cve,2016-10045; reference:cve,2016-10074; reference:url,legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html;  sid:45917; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP SERVER-WEBAPP Open WebMail userstat.pl command injection attempt"; flow:to_server,established; content:"userstat.pl"; fast_pattern:only; http_uri; content:"loginname"; nocase; http_client_body; content:"Content-Disposition"; nocase; http_client_body; pcre:"/name\s*=\s*[\x22\x27]?loginname((?!^--).)*?[\r\n]{2,}((?!^--).)*?([\x60\x3b\x7c\x26]|[\x3c\x3e\x24]\x28)/Psim"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,10316;  sid:45843; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP SERVER-WEBAPP Open WebMail userstat.pl command injection attempt"; flow:to_server,established; content:"userstat.pl"; fast_pattern:only; http_uri; content:"loginname="; nocase; http_client_body; pcre:"/(^|&)loginname=[^&]*?([\x60\x3b\x7c]|[\x3c\x3e\x24]\x28|%60|%3b|%7c|%26|%3c%28|%3e%28|%24%28)/Pim"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,10316;  sid:45842; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP SERVER-WEBAPP Open WebMail userstat.pl command injection attempt"; flow:to_server,established; content:"userstat.pl"; fast_pattern:only; http_uri; content:"loginname="; nocase; http_uri; content:"%26"; http_raw_uri; pcre:"/[?&]loginname=[^&]*?%26/Ii"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,10316;  sid:45841; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP SERVER-WEBAPP Open WebMail userstat.pl command injection attempt"; flow:to_server,established; content:"userstat.pl"; fast_pattern:only; http_uri; content:"loginname="; nocase; http_uri; pcre:"/[?&]loginname=[^&]*?([\x60\x3b\x7c]|[\x3c\x3e\x24]\x28)/Ui"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,10316;  sid:45840; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP /bin/sh access"; flow:to_server,established; content:"|22|/bin/sh|22|"; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, service http;  sid:45834; rev:1;)

alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SERVER-WEBAPP PHP unserialize integer overflow attempt"; flow:to_server,established; file_data; content:"o:"; depth:10; content:"|3B|a:"; content:!":{"; within:9; content:":{"; within:35; distance:10; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,95371; reference:cve,2017-5340;  sid:45769; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $FILE_DATA_PORTS (msg:"SERVER-WEBAPP PHP unserialize integer overflow attempt"; flow:to_client,established; file_data; content:"o:"; depth:10; content:"|3B|a:"; content:!":{"; within:9; content:":{"; within:35; distance:10; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,95371; reference:cve,2017-5340;  sid:45768; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHPUnit PHP remote code execution attempt"; flow:to_server,established; content:"/phpunit/src/Util/PHP/eval-stdin.php"; fast_pattern:only; http_uri; content:"<?"; http_client_body; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-9841;  sid:45749; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP HP IMC TopoMsgServlet arbitrary Java object deserialization attempt"; flow:to_server,established; content:"/imc/topo/topomsgservlet"; fast_pattern:only; http_uri; content:"|AC ED|"; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-8966; reference:url,support.hpe.com/hpsc/doc/public/display?docId=emr_na-hpesbhf03787en_us;  sid:45748; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 22006 (msg:"SERVER-WEBAPP Ulterius web server directory traversal attempt"; flow:to_server,established; content:"GET /c|3A|/"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-16806; reference:url,github.com/rapid7/metasploit-framework/blob/b533ec60190dcc4cf14ac18867b4b782b702b1ad/modules/auxiliary/admin/http/ulterius_file_download.rb;  sid:45722; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 22006 (msg:"SERVER-WEBAPP Ulterius web server directory traversal attempt"; flow:to_server,established; content:"GET /.../"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-16806; reference:url,github.com/rapid7/metasploit-framework/blob/b533ec60190dcc4cf14ac18867b4b782b702b1ad/modules/auxiliary/admin/http/ulterius_file_download.rb;  sid:45721; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Advantech WebAccess SQL injection attempt"; flow:to_server,established; content:"/BWMobileService/BWScadaRest.svc/Login/"; fast_pattern:only; http_uri; pcre:"/\/BWMobileService\/BWScadaRest\.svc\/Login\/.*([\x27\x22\x3b\x23]|\x2f\x2a|\x2d\x2d)/Ui"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-16716;  sid:45688; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP HP IMC mibBrowser arbitrary Java object deserialization attempt"; flow:to_server,established; content:"/imc/topo/mibBrowserTopoFilterServlet"; fast_pattern:only; http_uri; content:"|AC ED|"; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,101152; reference:cve,2017-12556; reference:url,support.hpe.com/hpsc/doc/public/display?docId=emr_na-hpesbhf03778en_us;  sid:45677; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP php_mime_split multipart file upload buffer overflow attempt"; flow:to_server,established; content:"Content-Disposition: form-data|3B| name=|22|0x08|22 0D 0A 0D 0A|"; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, service http; reference:cve,2002-0081;  sid:45676; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP unserialize call SPL ArrayObject and SPLObjectStorage memory corruption attempt"; flow:to_server,established; file_data; content:"x:i:"; content:"|3B|m:b"; within:100; fast_pattern; metadata:policy max-detect-ips drop, service http; reference:cve,2014-3515;  sid:44749; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP unserialize call SPL ArrayObject and SPLObjectStorage memory corruption attempt"; flow:to_server,established; file_data; content:"x:i:"; content:"|3B|m:N"; within:100; fast_pattern; metadata:policy max-detect-ips drop, service http; reference:cve,2014-3515;  sid:44748; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SERVER-WEBAPP PHP unserialize call SPL ArrayObject and SPLObjectStorage memory corruption attempt"; flow:to_server,established; file_data; content:"x:i:"; content:"|3B|m:b"; within:100; fast_pattern; metadata:policy max-detect-ips drop, service smtp; reference:cve,2014-3515;  sid:44747; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SERVER-WEBAPP PHP unserialize call SPL ArrayObject and SPLObjectStorage memory corruption attempt"; flow:to_server,established; file_data; content:"x:i:"; content:"|3B|m:N"; within:100; fast_pattern; metadata:policy max-detect-ips drop, service smtp; reference:cve,2014-3515;  sid:44746; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SERVER-WEBAPP PHP unserialize call SPL ArrayObject and SPLObjectStorage memory corruption attempt"; flow:to_client,established; file_data; content:"x:i:"; content:"|3B|m:b"; within:100; fast_pattern; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-3515;  sid:44745; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SERVER-WEBAPP PHP unserialize call SPL ArrayObject and SPLObjectStorage memory corruption attempt"; flow:to_client,established; file_data; content:"x:i:"; content:"|3B|m:N"; within:100; fast_pattern; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-3515;  sid:44744; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP form-based file upload DoS attempt"; flow:to_server,established; content:"POST"; http_method; content:"Content-Type: multipart/form-data"; fast_pattern:only; nocase; http_header; content:"Content-Disposition:"; nocase; content:"form-data"; within:50; content:!"|0D 0A 0D 0A|"; within:100; pcre:"/form-data[^\r]*?\n([^\s:]+?\n){5}/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2015-4024;  sid:44390; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Java XML deserialization remote code execution attempt"; flow:to_server,established; content:"Content-Type|3A|"; http_header; content:"application/xml"; within:20; http_header; content:"java.lang.ProcessBuilder"; fast_pattern:only; http_client_body; content:"<command"; http_client_body; content:"<string"; distance:0; http_client_body; pcre:"/<\w+\s+class\s*?\x3D\s*?[\x22\x27]java.lang.ProcessBuilder[\x22\x27]\s*?>.*?<command.*?<string/Pis"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-9805; reference:url,struts.apache.org/docs/s2-052.html;  sid:44315; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle Secure Backup web tool command injection attempt"; flow:to_server,established; content:"login.php"; http_uri; content:"uname"; fast_pattern; nocase; http_client_body; content:"Content-Disposition"; nocase; http_client_body; pcre:"/name\s*=\s*[\x22\x27]?uname((?!^--).)*?[\r\n]{2,}((?!^--).)*?%0a/Psim"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2011-2261;  sid:44312; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle Secure Backup web tool command injection attempt"; flow:to_server,established; content:"login.php"; http_uri; content:"uname="; fast_pattern; nocase; http_client_body; pcre:"/(^|&)uname=[^&]*?%0a/Pim"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2011-2261;  sid:44311; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle Secure Backup web tool command injection attempt"; flow:to_server,established; content:"login.php"; http_uri; content:"uname="; fast_pattern; nocase; http_uri; pcre:"/[?&]uname=[^&]*?%0a/Ui"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2011-2261;  sid:44310; rev:3;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP malformed quoted printable denial of service attempt"; flow:to_server,established; content:".php?"; http_raw_uri; content:"=|25|"; distance:0; http_raw_uri; content:"|25|"; within:1; distance:2; http_raw_uri; content:"|25|"; within:1; distance:2; http_raw_uri; content:"|25|"; within:1; distance:2; http_raw_uri; content:"|25|"; within:1; distance:2; http_raw_uri; content:"|25|"; within:1; distance:2; http_raw_uri; pcre:"/\x3D\x25[a-f0-9]{2}(\x25[a-f0-9]{2}){10}/Im"; metadata:policy max-detect-ips drop, service http; reference:cve,2013-2110;  sid:44001; rev:3;)

alert tcp $HOME_NET any -> $EXTERNAL_NET 5080 (msg:"SERVER-WEBAPP XML entity parsing information disclosure attempt"; flow:to_server,established; content:"<!DOCTYPE "; nocase; content:"<!ENTITY"; distance:0; nocase; pcre:"/<!ENTITY[^>]*?(SYSTEM|PUBLIC)/i"; metadata:policy max-detect-ips drop, service http; reference:cve,2017-7664; reference:url,openmeetings.apache.org/security.html;  sid:43814; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP phpSecurePages secure.php remote file include attempt"; flow:to_server,established; content:"/phpSecurePages/secure.php"; fast_pattern:only; http_uri; content:"cfgProgDir="; nocase; http_client_body; content:"tp:|2F|"; within:20; nocase; http_client_body; metadata:policy max-detect-ips drop, service http; reference:cve,2001-1468;  sid:43681; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP phpSecurePages secure.php remote file include attempt"; flow:to_server,established; content:"/phpSecurePages/secure.php"; fast_pattern:only; http_uri; content:"cfgProgDir="; nocase; http_uri; content:"tp:|2F|"; within:20; nocase; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2001-1468;  sid:43680; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP core unserialize use after free attempt"; flow:to_server,established; file_data; content:"O|25|3A"; fast_pattern:only; content:"|25|7Bs|25|3A"; content:"a|25|3A"; distance:0; content:"s|25|3A"; distance:0; content:"R|25|3A"; content:"POST"; http_method; metadata:policy max-detect-ips drop, service http; reference:cve,2014-8142;  sid:43668; rev:3;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Pheap edit.php directory traversal attempt"; flow:to_server,established; content:"/edit.php"; fast_pattern:only; http_uri; content:"filename"; nocase; http_client_body; content:"Content-Disposition"; nocase; http_client_body; pcre:"/filename\s*=\s*[^\r\n]*?(\x2e|%2e){2}([\x2f\x5c]|%2f|%5c)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2007-1140;  sid:43655; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Pheap edit.php directory traversal attempt"; flow:to_server,established; content:"/edit.php"; fast_pattern:only; http_uri; content:"filename="; nocase; http_client_body; pcre:"/(^|&)filename=[^&]*?(\x2e|%2e){2}([\x2f\x5c]|%2f|%5c)/Pim"; metadata:policy max-detect-ips drop, service http; reference:cve,2007-1140;  sid:43654; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Pheap edit.php directory traversal attempt"; flow:to_server,established; content:"/edit.php"; fast_pattern:only; http_uri; content:"filename="; nocase; http_uri; content:"../"; http_uri; pcre:"/[?&]filename=[^&]*?\x2e\x2e\x2f/Ui"; metadata:policy max-detect-ips drop, service http; reference:cve,2007-1140;  sid:43653; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle Application Framework diagnostic information disclosure attempt"; flow:to_server,established; content:"/OA_HTML/RF.jsp"; fast_pattern:only; http_uri; content:"OADiagnostic=1|3B|"; http_cookie; metadata:policy max-detect-ips drop, service http; reference:cve,2013-0397;  sid:43568; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle Application Framework diagnostic information disclosure attempt"; flow:to_server,established; content:"/OA_HTML/RF.jsp"; fast_pattern:only; http_uri; content:"OADeveloperMode=1|3B|"; http_cookie; metadata:policy max-detect-ips drop, service http; reference:cve,2013-0397;  sid:43567; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP MySQL Commander remote file include attempt"; flow:to_server,established; content:"/ressourcen/dbopen.php"; fast_pattern:only; http_uri; content:"home="; nocase; http_uri; content:"|3A|/"; http_uri; pcre:"/[?&]home=[^&]*?(http|ftp)/Ui"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,22941; reference:cve,2007-1439;  sid:43392; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP MySQL Commander remote file include attempt"; flow:to_server,established; content:"/ressourcen/dbopen.php"; fast_pattern:only; http_uri; content:"home="; nocase; http_client_body; pcre:"/(^|&)home=[^&]*?(http|ftp)/Pim"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,22941; reference:cve,2007-1439;  sid:43391; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle Application Server 9i unauthenticated dms access attempt"; flow:to_server,established; content:"/oprocmgr-service"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2002-0563;  sid:43357; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle Application Server 9i unauthenticated dms access attempt"; flow:to_server,established; content:"/fcgi-bin/echo"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2002-0563;  sid:43356; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle Application Server 9i unauthenticated dms access attempt"; flow:to_server,established; content:"/dms/DMSDump"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2002-0563;  sid:43355; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle Application Server 9i unauthenticated dms access attempt"; flow:to_server,established; content:"/dms/AggreSpy"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2002-0563;  sid:43354; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle Application Server 9i unauthenticated dms access attempt"; flow:to_server,established; content:"/demo/email/sendmail.jsp"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2002-0563;  sid:43353; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle Application Server 9i unauthenticated dms access attempt"; flow:to_server,established; content:"/demo/basic/info/info.jsp"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2002-0563;  sid:43352; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle Application Server 9i unauthenticated application deployment attempt"; flow:to_server,established; content:"/soap/soaplet/soaprouter"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2001-1371;  sid:43291; rev:3;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP /ws_ftp.log file access attempt"; flow:to_server,established; content:"/ws_ftp.log"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http;  sid:43290; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP /etc/shadow file access attempt"; flow:to_server,established; content:"/etc/shadow"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1087;  sid:43289; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP /etc/motd file access attempt"; flow:to_server,established; content:"/etc/motd"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1087;  sid:43288; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP /etc/inetd.conf file access attempt"; flow:to_server,established; content:"/etc/inetd.conf"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1087;  sid:43287; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP /cgi-bin/sh file access attempt"; flow:to_server,established; content:"/cgi-bin/sh"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http;  sid:43286; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP /.svn/entries file access attempt"; flow:to_server,established; content:"/.svn/entries"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http;  sid:43285; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP .NET AjaxControlToolkit directory traversal remote code execution attempt"; flow:to_server,established; content:"/AjaxFileUploadHandler.axd"; fast_pattern:only; http_uri; content:"fileId"; nocase; http_client_body; content:"Content-Disposition"; nocase; http_client_body; pcre:"/name\s*=\s*[\x22\x27]?fileId((?!^--).)*?\x2e\x2e[\x2f\x5c]/Psim"; metadata:policy max-detect-ips drop, service http; reference:cve,2015-4670;  sid:43283; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP .NET AjaxControlToolkit directory traversal remote code execution attempt"; flow:to_server,established; content:"/AjaxFileUploadHandler.axd"; fast_pattern:only; http_uri; content:"fileId="; nocase; http_client_body; pcre:"/(^|&)fileId=[^&]*?(\x2e|%2e){2}([\x2f\x5c]|%2f|%5c)/Pim"; metadata:policy max-detect-ips drop, service http; reference:cve,2015-4670;  sid:43282; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP .NET AjaxControlToolkit directory traversal remote code execution attempt"; flow:to_server,established; content:"/AjaxFileUploadHandler.axd"; fast_pattern:only; http_uri; content:"fileId="; nocase; http_uri; content:"../"; http_uri; pcre:"/[?&]fileId=[^&]*?\x2e\x2e\x2f/Ui"; metadata:policy max-detect-ips drop, service http; reference:cve,2015-4670;  sid:43281; rev:2;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache TomEE java deserialization attempt"; flow:to_server,established; content:"PUT"; http_method; content:"|0D 0A 0D 0A AC ED 00 05 73 72|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2016-0779; reference:url,tomee.apache.org/security/tomee.html;  sid:42879; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache TomEE java deserialization attempt"; flow:to_server,established; content:"POST"; http_method; content:"|AC ED 00 05 73 72|"; depth:6; http_client_body; metadata:policy max-detect-ips drop, service http; reference:cve,2016-0779; reference:cve,2017-3248; reference:url,tomee.apache.org/security/tomee.html;  sid:42878; rev:3;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Struts URL validator denial of service attempt"; flow:to_server,established; content:"tp://"; nocase; http_client_body; content:"/////"; within:100; http_client_body; pcre:"/(https?|ftp)\x3a\x2f\x2f[^&\x0d\x0a=]*?(\x2f){5}/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-4465; reference:url,cwiki.apache.org/confluence/display/WW/S2-041;  sid:41850; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SERVER-WEBAPP pfSense status_rrd_graph_img.php command injection via CSRF attempt"; flow:to_client,established; file_data; content:"/status_rrd_graph_img.php"; fast_pattern:only; content:"graph="; nocase; pcre:"/[?&]graph=[^&]*?([\x60\x3b\x7c]|[\x3c\x3e\x24]\x28|%60|%3b|%7c|%26|%3c%28|%3e%28|%24%28)/i"; metadata:policy max-detect-ips drop, service http; reference:url,www.pfsense.org/security/advisories/pfSense-SA-16_01.webgui.asc;  sid:41845; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP phpFileManager cmd parameter command injection attempt"; flow:to_server,established; content:"action=9"; fast_pattern:only; http_client_body; content:"/index.php"; http_uri; content:"cmd="; nocase; http_client_body; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2015-5958; reference:url,www.securityfocus.com/archive/1/536117;  sid:41844; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP phpFileManager cmd parameter command injection attempt"; flow:to_server,established; content:"action=6"; fast_pattern:only; http_client_body; content:"/index.php"; http_uri; content:"cmd="; nocase; http_client_body; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2015-5958; reference:url,www.securityfocus.com/archive/1/536117;  sid:41843; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP phpFileManager cmd parameter command injection attempt"; flow:to_server,established; content:"action=9"; fast_pattern:only; http_uri; content:"/index.php"; http_uri; content:"cmd="; nocase; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2015-5958; reference:url,www.securityfocus.com/archive/1/536117;  sid:41842; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP phpFileManager cmd parameter command injection attempt"; flow:to_server,established; content:"action=6"; fast_pattern:only; http_uri; content:"/index.php"; http_uri; content:"cmd="; nocase; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2015-5958; reference:url,www.securityfocus.com/archive/1/536117;  sid:41841; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP unserialize function use after free memory corruption vulnerability attempt"; flow:to_server,established; content:".php"; http_uri; content:"O:"; fast_pattern; http_uri; pcre:"/O:\d+:\x22\w+\x22:\d+:.*s:(29|[3-9]\d|\d{3})\d+:/smiU"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-7479; reference:url,bugs.php.net/bug.php?id=71311;  sid:41433; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP unserialize function use after free memory corruption vulnerability attempt"; flow:to_server,established; content:".php"; fast_pattern:only; http_uri; content:"O:"; http_client_body; pcre:"/O:\d+:\x22\w+\x22:\d+:.*s:(29|[3-9]\d|\d{3})\d+:/smiP"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-7479; reference:url,bugs.php.net/bug.php?id=71311;  sid:41432; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP unserialize function use after free memory corruption vulnerability attempt"; flow:to_server,established; content:"DateInterval|22|:"; fast_pattern:only; http_uri; content:"O:"; http_uri; content:"x:i:0"; distance:0; nocase; http_uri; pcre:"/O:\d+:\x22DateInterval\x22:\d+:.*C:\d+:\x22\w+\x22:\d+:\x7b.*x:i:0.*\x3b\x3bm:r:/smiU"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-7479; reference:url,bugs.php.net/bug.php?id=71311;  sid:41431; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP unserialize function use after free memory corruption vulnerability attempt"; flow:to_server,established; content:"DateInterval|22|:"; fast_pattern:only; http_client_body; content:"O:"; http_client_body; content:"x:i:0"; distance:0; nocase; http_client_body; pcre:"/O:\d+:\x22DateInterval\x22:\d+:.*C:\d+:\x22\w+\x22:\d+:\x7b.*x:i:0.*\x3b\x3bm:r:/smiP"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-7479; reference:url,bugs.php.net/bug.php?id=71311;  sid:41430; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP ZipArchive getFromIndex and getFromName integer overflow attempt"; flow:to_server,established; file_data; content:"PK|01 02|"; fast_pattern; content:"|00 00|"; within:2; distance:18; byte_test:4,>=,0x00FFFFFF,0,relative,little; metadata:policy max-detect-ips drop, service http; reference:cve,2016-3078; reference:url,bugs.php.net/bug.php?id=71923;  sid:41384; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP ZipArchive getFromIndex and getFromName integer overflow attempt"; flow:to_server,established; content:".php"; fast_pattern:only; http_uri; file_data; content:"PK|03 04|"; content:"|00 00|"; within:2; distance:16; byte_test:4,>=,0x00FFFFFF,0,relative,little; metadata:policy max-detect-ips drop, service http; reference:cve,2016-3078; reference:url,bugs.php.net/bug.php?id=71923;  sid:41383; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP unserialize var_hash use-after-free attempt"; flow:to_server,established; file_data; content:"session.serialize_handler"; fast_pattern:only; content:"xi:"; content:"session_decode"; within:75; nocase; content:"unserialize"; nocase; content:"unset"; within:75; nocase; content:"R|3A|"; distance:0; nocase; content:"unserialize"; within:75; nocase; metadata:policy max-detect-ips drop, service http; reference:cve,2016-6290; reference:url,bugs.php.net/bug.php?id=72562;  sid:40038; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP phpFileManager command injection attempt"; flow:to_server,established; content:"/phpFileManager-0.9.8/index.php"; fast_pattern:only; http_uri; content:"cmd"; nocase; http_client_body; content:"Content-Disposition"; nocase; http_client_body; pcre:"/name\s*=\s*[\x22\x27]?cmd((?!^--).)*?[\r\n]{2,}((?!^--).)*?([\x60\x3b\x7c\x26]|\x24\x28)/Psim"; metadata:policy max-detect-ips drop, service http; reference:url,phpfm.sourceforge.net/;  sid:39717; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP phpFileManager command injection attempt"; flow:to_server,established; content:"/phpFileManager-0.9.8/index.php"; fast_pattern:only; http_uri; content:"cmd="; nocase; http_client_body; pcre:"/(^|&)cmd=[^&]*?([\x60\x3b\x7c]|\x24\x28|%60|%3b|%7c|%26|%24%28)/Pim"; metadata:policy max-detect-ips drop, service http; reference:url,phpfm.sourceforge.net/;  sid:39716; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP phpFileManager command injection attempt"; flow:to_server,established; content:"/phpFileManager-0.9.8/index.php"; fast_pattern:only; http_uri; content:"cmd="; nocase; http_raw_uri; content:"%26"; distance:0; http_raw_uri; pcre:"/[?&]action=[^&]*?%26/Ii"; metadata:policy max-detect-ips drop, service http; reference:url,phpfm.sourceforge.net/;  sid:39715; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP phpFileManager command injection attempt"; flow:to_server,established; content:"/phpFileManager-0.9.8/index.php"; fast_pattern:only; http_uri; content:"cmd="; nocase; http_uri; pcre:"/[?&]cmd=[^&]*?([\x60\x3b\x7c]|\x24\x28)/Ui"; metadata:policy max-detect-ips drop, service http; reference:url,exploit-db.com/exploits/37709;  sid:39714; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP phar extension remote code execution attempt"; flow:to_server,established; file_data; content:"filename="; http_client_body; content:"|00|"; within:60; http_client_body; content:".phar"; within:60; http_client_body; metadata:policy max-detect-ips drop, service http; reference:cve,2016-4072; reference:url,bugs.php.net/bug.php?id=71860; reference:url,php.net/ChangeLog-7.php;  sid:39662; rev:3;)

alert tcp $EXTERNAL_NET any -> $HOME_NET 7777 (msg:"SERVER-WEBAPP Oracle Web Cache HTTP header null byte injection attempt"; flow:to_server,established; content:"Header: |00|"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,9868; reference:cve,2004-0385;  sid:39459; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP-Address remote file include attempt"; flow:to_server,established; content:"globals.php"; fast_pattern:only; http_uri; content:"LangCookie="; nocase; http_uri; pcre:"/[?&]LangCookie=[^&]*?(http|ftp)/Ui"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,5039; reference:cve,2002-0953;  sid:38807; rev:2;)

alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP Apache HTTP server potential cookie disclosure attempt"; flow:to_server,established; content:"Cookie|3A 20|"; http_raw_header; isdataat:8192,relative; content:!"|0A|"; within:8192; http_raw_header; metadata:policy max-detect-ips drop, service http; reference:bugtraq,51706; reference:cve,2012-0053;  sid:37968; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET [1099,6099,7001,$HTTP_PORTS] (msg:"SERVER-WEBAPP Java Library CommonsCollection unauthorized serialized object attempt"; flow:to_server,established; content:"|AC ED 00 05|"; content:"/runtime/callsite/"; distance:0; content:"|00 0C|java.io.File"; distance:0; content:"|70 74 00 07|execute"; within:100; content:"|00 08|entrySet|76 72 00 12|java.lang.Override"; distance:0; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service java_rmi; reference:cve,2015-3253; reference:cve,2015-4852; reference:cve,2015-7450; reference:cve,2015-8103; reference:cve,2016-0638; reference:cve,2016-4385; reference:cve,2017-15708; reference:url,foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/#weblogic; reference:url,github.com/frohoff/ysoserial;  sid:37860; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [1099,6099,7001,$HTTP_PORTS] (msg:"SERVER-WEBAPP Java Library CommonsCollection unauthorized serialized object attempt"; flow:to_server,established; content:"|AC ED 00 05|"; content:"getRuntime"; distance:0; content:"Ljava/lang/Runtime|3B|"; within:30; content:"exec|01 00 27|(Ljava/lang/String|3B|"; distance:0; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service java_rmi; reference:cve,2015-3253; reference:cve,2015-4852; reference:cve,2015-7450; reference:cve,2015-8103; reference:cve,2016-1291; reference:cve,2016-4385; reference:cve,2017-15708; reference:cve,2020-14625; reference:url,github.com/frohoff/ysoserial;  sid:37859; rev:6;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP fileinfo cdf_read_property_info denial of service attempt"; flow:to_server,established; flowbits:isset,file.ole; file_data; content:"|FE FF|"; content:"|E0 85 9F F2 F9 4F 68 10 AB 91 08 00 2B 27 B3 D9|"; within:26; distance:16; fast_pattern; byte_test:4,>,0,16,relative,little; byte_test:4,<,8,16,relative,little; metadata:policy max-detect-ips drop, service http; reference:bugtraq,69325; reference:cve,2014-3587; reference:url,php.net/ChangeLog-5.php|23|5.6.0;  sid:36262; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP fileinfo cdf_read_property_info denial of service attempt"; flow:to_server,established; flowbits:isset,file.ole; file_data; content:"|FE FF|"; content:"|E0 85 9F F2 F9 4F 68 10 AB 91 08 00 2B 27 B3 D9|"; within:26; distance:16; fast_pattern; byte_test:1,&,0x80,19,relative; metadata:policy max-detect-ips drop, service http; reference:bugtraq,69325; reference:cve,2014-3587; reference:url,php.net/ChangeLog-5.php|23|5.6.0;  sid:36261; rev:3;)

alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SERVER-WEBAPP PHP php_parse_metadata heap corruption attempt"; flow:to_server,established; flowbits:isset,file.tar; file_data; content:"__HALT_COMPILER()|3B|"; fast_pattern:only; content:"ustar|00|00"; depth:8; offset:257; content:"00000000000|00|"; depth:12; offset:124; metadata:policy max-detect-ips drop, service smtp; reference:cve,2015-3307;  sid:35041; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SERVER-WEBAPP PHP php_parse_metadata heap corruption attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"__HALT_COMPILER()|3B|"; fast_pattern:only; content:"ustar|00|00"; depth:8; offset:257; content:"00000000000|00|"; depth:12; offset:124; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-3307;  sid:35040; rev:2;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP unserialize call SPL ArrayObject and SPLObjectStorage memory corruption attempt"; flow:to_server,established; content:"x:i:"; content:"|3B|m:i"; within:100; fast_pattern; metadata:policy max-detect-ips drop, service http; reference:cve,2014-3515;  sid:35011; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP unserialize call SPL ArrayObject and SPLObjectStorage memory corruption attempt"; flow:to_server,established; content:"x:i:"; content:"|3B|m:s"; within:100; fast_pattern; metadata:policy max-detect-ips drop, service http; reference:cve,2014-3515;  sid:35010; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SERVER-WEBAPP PHP unserialize call SPL ArrayObject and SPLObjectStorage memory corruption attempt"; flow:to_server,established; file_data; content:"x:i:"; content:"|3B|m:i"; within:100; fast_pattern; metadata:policy max-detect-ips drop, service smtp; reference:cve,2014-3515;  sid:35009; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SERVER-WEBAPP PHP unserialize call SPL ArrayObject and SPLObjectStorage memory corruption attempt"; flow:to_client,established; file_data; content:"x:i:"; content:"|3B|m:i"; within:100; fast_pattern; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-3515;  sid:35008; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SERVER-WEBAPP PHP unserialize call SPL ArrayObject and SPLObjectStorage memory corruption attempt"; flow:to_server,established; file_data; content:"x:i:"; content:"|3B|m:s"; within:100; fast_pattern; metadata:policy max-detect-ips drop, service smtp; reference:cve,2014-3515;  sid:35007; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SERVER-WEBAPP PHP unserialize call SPL ArrayObject and SPLObjectStorage memory corruption attempt"; flow:to_client,established; file_data; content:"x:i:"; content:"|3B|m:s"; within:100; fast_pattern; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-3515;  sid:35006; rev:3;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP xmlrpc.php command injection attempt"; flow:to_server,established; content:"POST"; depth:4; nocase; content:"/xmlrpc.php"; within:50; fast_pattern; nocase; content:"<methodCall><methodName>"; within:500; nocase; content:"<params><param><value>"; within:100; nocase; content:"echo"; within:500; nocase; content:"|60|"; within:100; metadata:policy max-detect-ips drop, service http; reference:bugtraq,14088; reference:cve,2005-1921;  sid:33632; rev:3;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP httpd.conf access"; flow:to_server,established; content:"httpd.conf"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http;  sid:33611; rev:2;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP bin access"; flow:to_server,established; content:"/~bin"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http;  sid:33608; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP cron access"; flow:to_server,established; content:"/~cron"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http;  sid:33607; rev:2;)


alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SERVER-WEBAPP phpMemcachedAdmin path traversal attempt"; flow:to_server,established; content:"live_stats_id"; fast_pattern:only; content:"live_stats_id"; http_cookie; content:"="; within:1; distance:32; http_cookie; content:"../"; distance:0; http_cookie; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2014-8731; reference:url,securityfocus.com/archive/1/533968;  sid:32611; rev:3;)


alert tcp $HOME_NET $FILE_DATA_PORTS -> $EXTERNAL_NET any (msg:"SERVER-WEBAPP /etc/passwd file access attempt"; flow:to_client, established; file_data; content:"root:x:0:0:root:/root:/"; fast_pattern:only; content:!"html"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,attack.mitre.org/techniques/T1087; reference:url,www.tldp.org/LDP/lame/LAME/linux-admin-made-easy/shadow-file-formats.html;  sid:31289; rev:5;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP XML entity parsing information disclosure attempt"; flow:to_server,established; content:"<!DOCTYPE "; nocase; http_client_body; content:"<!ENTITY"; distance:0; nocase; http_client_body; pcre:"/<!ENTITY[^>]*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,65051; reference:cve,2010-2076; reference:cve,2012-3363; reference:cve,2013-4152; reference:cve,2013-5014; reference:cve,2013-6447; reference:cve,2015-1818; reference:cve,2015-6662; reference:cve,2017-5644;  sid:24339; rev:14;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP-CGI command injection attempt"; flow:to_server,established; content:"-s"; http_uri; content:!"="; http_raw_uri; pcre:"/\x3F\s*?-s/Ui"; metadata:policy max-detect-ips drop, service http; reference:cve,2012-1823; reference:cve,2012-2311; reference:cve,2012-2335; reference:cve,2012-2336;  sid:22097; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP-CGI command injection attempt"; flow:to_server,established; content:".php?"; http_uri; content:"-s"; nocase; http_uri; content:!"="; http_raw_uri; pcre:"/\x2ephp\x3f\s*-s/Ui"; metadata:policy max-detect-ips drop, service http; reference:cve,2012-1823; reference:cve,2012-2311; reference:cve,2012-2335; reference:cve,2012-2336;  sid:22064; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP-CGI remote file include attempt"; flow:to_server,established; content:"auto_prepend_file"; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:cve,2012-1823; reference:cve,2012-2311; reference:cve,2012-2335; reference:cve,2012-2336;  sid:22063; rev:11;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP uselang code injection"; flow:to_server,established; content:"/wiki"; nocase; http_uri; content:"?uselang="; fast_pattern; nocase; http_uri; pcre:"/\x2fwiki[^\n]*\x3fuselang=[^\n\x26\x3f]{2,}[a-zA-Z\x2d]/Usmi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,15703; reference:cve,2005-4031;  sid:16079; rev:15;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP memory_limit vulnerability exploit attempt"; flow:to_server,established; content:"---------------------------153501500631101"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, service http; reference:bugtraq,10725; reference:cve,2004-0594;  sid:16078; rev:6;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP strip_tags bypass vulnerability exploit attempt"; flow:to_server,established; content:"/strip/getPoc.php?"; fast_pattern:only; http_uri; content:"|00|"; http_uri; metadata:policy max-detect-ips drop, service http; reference:bugtraq,10724; reference:cve,2004-0595;  sid:15977; rev:10;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP alternate xmlrpc.php command injection attempt"; flow:to_server,established; content:"POST"; http_method; content:"xml version"; http_client_body; content:"<methodCall><methodName>"; distance:0; http_client_body; content:"</methodName><params><param><value><string></string></value></param><param><value><string>"; distance:0; http_client_body; content:"AND ascii|28|substring|28|pass,1,1|29 29 0A|/**/BETWEEN/**/52/**/AND/**/58|29|/*"; http_client_body; metadata:policy max-detect-ips drop, service http; reference:bugtraq,14088; reference:cve,2005-1921;  sid:13818; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP xmlrpc.php command injection attempt"; flow:to_server,established; content:"POST"; http_method; content:"xml version"; http_client_body; content:"<methodCall><methodName>"; distance:0; http_client_body; content:"</methodName><params><param><value><name>"; distance:0; http_client_body; content:"',''|29 29 3B|echo '_begin_|0A|'|3B|echo"; distance:0; http_client_body; metadata:policy max-detect-ips drop, service http; reference:bugtraq,14088; reference:cve,2005-1921;  sid:13817; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP xmlrpc.php command injection attempt"; flow:to_server,established; content:"POST"; http_method; content:"xml version"; http_client_body; content:"<methodCall><methodName>"; distance:0; http_client_body; content:"</methodName><params><param><name>"; distance:0; http_client_body; content:"'|29 3B|echo|28|'"; distance:0; http_client_body; content:"'|29 3B| passthru|28|chr|28|"; distance:0; http_client_body; metadata:policy max-detect-ips drop, service http; reference:bugtraq,14088; reference:cve,2005-1921;  sid:13816; rev:14;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP function CRLF injection attempt"; flow:to_server,established; content:".php"; http_uri; content:"|0A|"; http_uri; metadata:policy max-detect-ips drop, service http; reference:bugtraq,52630; reference:bugtraq,5681; reference:cve,2002-1783; reference:cve,2019-11043;  sid:12360; rev:11;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP encoded cross site scripting HTML Image tag attempt"; flow:to_server,established; content:"ONERROR="; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:bugtraq,5847; reference:cve,2002-0840;  sid:10990; rev:8;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Content-Length buffer overflow attempt"; flow:to_server,established; content:"Content-Length|3A|"; nocase; http_header; isdataat:100,relative; pcre:"/^Content-Length\x3A\s*[^\r\n]{100}/smiH"; metadata:policy max-detect-ips drop, service http; reference:cve,2007-1260; reference:url,djeyl.net/w.php;  sid:10195; rev:13;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP newsPHP Language file include attempt"; flow:to_server,established; content:"/nphpd.php"; fast_pattern; nocase; http_uri; content:"LangFile"; nocase; metadata:ruleset community, service http; reference:bugtraq,8488;  sid:2365; rev:12;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP cart.cgi access"; flow:to_server,established; content:"/cart.cgi"; fast_pattern:only; http_uri; metadata:ruleset community, service http; reference:bugtraq,1115; reference:cve,2000-0252; reference:nessus,10368;  sid:1933; rev:13;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP oracle web application server access"; flow:to_server,established; content:"/ows-bin/"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:bugtraq,1053; reference:cve,2000-0169; reference:nessus,10348;  sid:1880; rev:13;)


alert tcp $EXTERNAL_NET any -> $HOME_NET 9090 (msg:"SERVER-WEBAPP Oracle JavaServer default password login attempt"; flow:to_server,established; content:"/servlet/admin"; content:"ae9f86d6beaa3f9ecb9a5b7e072a4138"; metadata:ruleset community, service http; reference:nessus,10995; reference:url,attack.mitre.org/techniques/T1078;  sid:1859; rev:14;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP WEB-INF access"; flow:to_server,established; content:"/WEB-INF"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:bugtraq,1830; reference:bugtraq,5119; reference:cve,2000-1050; reference:cve,2001-0179; reference:nessus,11037;  sid:1826; rev:17;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP /home/www access"; flow:to_server,established; content:"/home/www"; fast_pattern:only; http_uri; metadata:ruleset community, service http; reference:nessus,11032;  sid:1671; rev:14;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP /cgi-dos/ access"; flow:to_server,established; content:"/cgi-dos/"; http_uri; content:"/cgi-dos/ HTTP"; fast_pattern:only; metadata:ruleset community, service http;  sid:1669; rev:13;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP /cgi-bin/ access"; flow:to_server,established; content:"/cgi-bin/"; http_uri; content:"/cgi-bin/ HTTP"; fast_pattern:only; metadata:ruleset community, service http;  sid:1668; rev:14;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP cross site scripting HTML Image tag set to javascript attempt"; flow:to_server,established; content:"img src=javascript"; fast_pattern:only; http_uri; metadata:ruleset community, service http; reference:bugtraq,4858; reference:cve,2002-0902;  sid:1667; rev:15;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP /cgi-bin/ls access"; flow:to_server,established; content:"/cgi-bin/ls"; fast_pattern:only; http_uri; metadata:ruleset community, service http; reference:bugtraq,936; reference:cve,2000-0079; reference:nessus,10037;  sid:1539; rev:19;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP apache ?M=D directory list attempt"; flow:to_server,established; content:"/?M=D"; http_uri; metadata:ruleset community, service http; reference:bugtraq,3009; reference:cve,2001-0731; reference:nessus,10704;  sid:1519; rev:16;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP upload.cgi access"; flow:to_server,established; content:"/upload.cgi"; fast_pattern:only; http_uri; metadata:ruleset community, service http; reference:nessus,10290;  sid:1481; rev:16;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP admin.php access"; flow:to_server,established; content:"/admin.php"; fast_pattern:only; http_uri; metadata:ruleset community, service http; reference:bugtraq,3361; reference:bugtraq,7532; reference:bugtraq,9270; reference:cve,2001-1032;  sid:1301; rev:23;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP admin.php file upload attempt"; flow:to_server,established; content:"/admin.php"; fast_pattern; nocase; http_uri; content:"file_name="; http_uri; metadata:ruleset community, service http; reference:bugtraq,3361; reference:cve,2001-1032;  sid:1300; rev:18;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP cat_ access"; flow:to_server,established; content:"cat "; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:bugtraq,374; reference:cve,1999-0039;  sid:1147; rev:21;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP /.... access"; flow:to_server,established; content:"/...."; metadata:ruleset community, service http;  sid:1142; rev:11;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP cd.."; flow:to_server,established; content:"cd.."; nocase; metadata:ruleset community, service http;  sid:1136; rev:11;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP /etc/passwd file access attempt"; flow:to_server,established; content:"/etc/passwd"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:url,attack.mitre.org/techniques/T1087;  sid:1122; rev:16;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP bash access"; flow:to_server,established; content:"/bash"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:cve,1999-0509; reference:url,www.cert.org/advisories/CA-1996-11.html;  sid:885; rev:21;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP rsh access"; flow:to_server,established; content:"/rsh"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:cve,1999-0509; reference:url,www.cert.org/advisories/CA-1996-11.html;  sid:868; rev:21;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP ksh access"; flow:to_server,established; content:"/ksh"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:cve,1999-0509; reference:url,www.cert.org/advisories/CA-1996-11.html;  sid:865; rev:20;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP csh access"; flow:to_server,established; content:"/csh"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:cve,1999-0509; reference:url,www.cert.org/advisories/CA-1996-11.html;  sid:862; rev:21;)



alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-WEBAPP Oracle WebLogic core server remote code execution attempt"; flow:to_server,established; content:"GIOP"; depth:4; content:"com.tangosol.util.aggregator.TopNAggregator"; content:"oracle.eclipselink.coherence.integrated.internal.querying.FilterExtractor"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop; reference:cve,2021-2394; reference:url,cdmana.com/2021/08/20210823062457738O.html;  sid:59109; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"HTTP/"; nocase; content:"${"; fast_pattern:only; pcre:"/HTTP\x2f((?![\r\n]{4}).)*?\x24\x7b(jndi|[^\r\n\x7d\x80-\xff]*?\x24\x7b[^\r\n\x7d\x80-\xff]*?\x3a[^\r\n\x7d]*?\x7d)/si"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:url,blog.talosintelligence.com/2021/12/apache-log4j-rce-vulnerability.html;  sid:59246; rev:1;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Java getRuntime remote code execution attempt"; flow:to_server,established; content:"<%"; http_header; content:"getRuntime"; distance:0; nocase; http_header; content:"exec("; distance:0; nocase; http_header; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2022-22965; reference:url,tanzu.vmware.com/security/cve-2022-22965;  sid:59416; rev:2;)

 
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Airflow trigger origin cross site scripting attempt"; flow:to_server,established; content:"/admin/airflow/trigger"; fast_pattern:only; http_uri; content:"origin="; nocase; http_client_body; pcre:"/(^|&)origin=[^&]*?([\x22\x27\x3c\x3e\x28\x29]|%(25)?(22|27|3c|3e|28|29)|script|onload|src)/Pim"; metadata:policy max-detect-ips drop, service http; reference:cve,2020-13944;  sid:59364; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Airflow trigger origin cross site scripting attempt"; flow:to_server,established; content:"/admin/airflow/trigger"; fast_pattern:only; http_uri; content:"origin="; nocase; http_uri; pcre:"/[?&]origin=[^&]*?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/Ui"; metadata:policy max-detect-ips drop, service http; reference:cve,2020-13944;  sid:59363; rev:1;)


alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-WEBAPP Oracle WebLogic Server insecure deserialization exploit attempt"; flow:to_server,established; content:"|AF 1F 77 F7 74 00 05 74 72 65 6E 64 74 00 09 74 72 65 6E 64 62 62 62 62 7A 00 00 01 24 00 00 01 20 9C 9B A1 86 84 29 B3|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2020-2963; reference:url,www.oracle.com/security-# alerts/cpuapr2020.html;  sid:59558; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-WEBAPP Oracle WebLogic Server insecure deserialization exploit attempt"; flow:to_server,established; content:"|7D 86 39 36 61 E8 4A F9 27 5B 59 C8 DD 1A 86 18 95 CF B8 AA 96 41 8A 0D 2D 72 25 DB D4 34 C9 BB DF D7 46 08 CB A9 46 53|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2020-2798; reference:url,www.oracle.com/security-# alerts/cpuapr2020.html;  sid:59557; rev:1;)


# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Subversion denial-of-service attempt"; flow:to_server,established; content:"<S|3A|list-report  xmlns|3A|S=|22|svn|3A 22|> </S|3A|list-report>"; fast_pattern:only; content:"/svn/repos"; nocase; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2018-11803; reference:url,lists.apache.org/thread/dsjxjc6zf4y452sw65yhb65xo0wt2ow7;  sid:59669; rev:1;)


alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP Apache httpd mod_lua req_parsebody denial of service attempt"; flow:to_server,established; content:".lua"; fast_pattern; http_uri; content:"POST"; http_method; content:"Content-Type: multipart/form-data|3B|"; http_header; content:"boundary="; http_header; content:"Content-Length: 0"; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2022-22719;  sid:60227; rev:1;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Spark command injection attempt"; flow:to_server,established; content:"doAs="; fast_pattern:only; http_uri; pcre:"/[?&]doAs=[^&]*?([\x60\x3b\x7c\x23\x0a]|[\x3c\x3e\x24]\x28)/Ui"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2022-33891;  sid:60361; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Spark command injection attempt"; flow:to_server,established; content:"doAs="; fast_pattern:only; http_uri; content:"26"; http_raw_uri; pcre:"/[?&]doAs=[^&]*?%(25)?26/Ii"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2022-33891;  sid:60360; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Spark command injection attempt"; flow:to_server,established; content:"doAs="; fast_pattern:only; http_client_body; pcre:"/(^|&)doAs=[^&]*?([\x60\x3b\x7c\x23]|%(25)?(60|3b|7c|23|26|0a)|([\x3c\x3e\x24]|%(25)?(3c|3e|24))(\x28|%(25)?28))/Pim"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2022-33891;  sid:60359; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Apache Spark command injection attempt"; flow:to_server,established; content:"doAs"; fast_pattern:only; http_client_body; content:"Content-Disposition"; nocase; http_client_body; pcre:"/name\s*=\s*[\x22\x27]?doAs((?!^--).)*?[\r\n]{2,}((?!^--).)*?([\x60\x3b\x7c\x26\x23]|[\x3c\x3e\x24]\x28)/Psim"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2022-33891;  sid:60358; rev:1;)
