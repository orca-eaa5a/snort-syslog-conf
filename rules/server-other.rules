# Copyright 2001-2022 Sourcefire, Inc. All Rights Reserved.
#
# This file contains (i) proprietary rules that were created, tested and certified by
# Sourcefire, Inc. (the "VRT Certified Rules") that are distributed under the VRT
# Certified Rules License Agreement (v 2.0), and (ii) rules that were created by
# Sourcefire and other third parties (the "GPL Rules") that are distributed under the
# GNU General Public License (GPL), v2.
# 
# The VRT Certified Rules are owned by Sourcefire, Inc. The GPL Rules were created
# by Sourcefire and other third parties. The GPL Rules created by Sourcefire are
# owned by Sourcefire, Inc., and the GPL Rules not created by Sourcefire are owned by
# their respective creators. Please see http://www.snort.org/snort/snort-team/ for a
# list of third party owners and their respective copyrights.
# 
# In order to determine what rules are VRT Certified Rules or GPL Rules, please refer
# to the VRT Certified Rules License Agreement (v2.0).
#
#--------------------
# SERVER-OTHER RULES
#--------------------


alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic malicious RemoteConstructor deserialization attempt"; flow:to_server,established; content:"com.tangosol.internal.util.invoke.RemoteConstructor"; fast_pattern:only; content:"ProcessBuilder"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service java_rmi; reference:cve,2020-14644; reference:url,www.oracle.com/security-alerts/cpujul2020.html;  sid:55933; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic malicious RemoteConstructor deserialization attempt"; flow:to_server,established; content:"com.tangosol.internal.util.invoke.RemoteConstructor"; fast_pattern:only; content:"getRuntime"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service java_rmi; reference:cve,2020-14644; reference:url,www.oracle.com/security-alerts/cpujul2020.html;  sid:55932; rev:1;)


alert tcp $EXTERNAL_NET any -> $HOME_NET 4560 (msg:"SERVER-OTHER Apache Log4j SocketServer insecure deserialization remote code execution attempt"; flow:to_server,established; content:"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl"; fast_pattern:only; content:"|AC ED 00 05|"; depth:4; content:"getRuntime"; content:"exec"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2019-17571; reference:url,issues.apache.org/jira/browse/AMQ-7372;  sid:53475; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic Server IIOP remote code execution attempt"; flow:to_server,established; content:"com.bea.core.repackaged.springframework."; fast_pattern:only; content:"bind_any"; nocase; content:"GIOP"; depth:4; pcre:"/(com\x2ebea\x2ecore\x2erepackaged\x2espringframework(\x2eaop\x2easpectj\x2e|beans\x2efactory\x2esupport\x2e|transaction\x2esupport\x2eAbstractPlatformTransactionManager))|(com\x2ebea\x2ecore\x2erepackaged\x2espringframework\x2etransaction\x2ejta\x2eJtaTransactionManager)/im"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2020-2551;  sid:53458; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic Server IIOP remote code execution attempt"; flow:to_server,established; content:"org.jboss.interceptor."; fast_pattern:only; content:"bind_any"; nocase; content:"GIOP"; depth:4; pcre:"/org\x2ejboss\x2einterceptor\x2e(builder|reader|proxy|spi\x2e(metadata|model))\x2e/im"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2020-2551;  sid:53457; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic Server IIOP remote code execution attempt"; flow:to_server,established; content:"org.python.core."; fast_pattern:only; content:"bind_any"; nocase; content:"GIOP"; depth:4; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2020-2551;  sid:53456; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic Server IIOP remote code execution attempt"; flow:to_server,established; content:"sun.rmi.server."; fast_pattern:only; content:"bind_any"; nocase; content:"GIOP"; depth:4; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2020-2551;  sid:53455; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic Server IIOP remote code execution attempt"; flow:to_server,established; content:"com.sun.org.apache.xalan.internal.xsltc.trax."; fast_pattern:only; content:"bind_any"; nocase; content:"GIOP"; depth:4; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2020-2551;  sid:53454; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic Server IIOP remote code execution attempt"; flow:to_server,established; content:"org.apache.commons.collections.functors."; fast_pattern:only; content:"bind_any"; nocase; content:"GIOP"; depth:4; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2020-2551;  sid:53453; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic Server IIOP remote code execution attempt"; flow:to_server,established; content:"java.rmi."; fast_pattern:only; content:"bind_any"; nocase; content:"GIOP"; depth:4; pcre:"/java\x2ermi\x2e(server\x2e(Unicast)?RemoteObject(InvocationHandler)?|activation\x2e)/im"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2020-2551;  sid:53452; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic Server IIOP remote code execution attempt"; flow:to_server,established; content:"org.springframework.transaction.support.AbstractPlatformTransactionManager"; fast_pattern:only; content:"bind_any"; nocase; content:"GIOP"; depth:4; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2020-2551;  sid:53451; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic Server IIOP remote code execution attempt"; flow:to_server,established; content:"javassist."; fast_pattern:only; content:"bind_any"; nocase; content:"GIOP"; depth:4; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2020-2551;  sid:53450; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic Server IIOP remote code execution attempt"; flow:to_server,established; content:"org.codehaus.groovy.runtime."; fast_pattern:only; content:"bind_any"; nocase; content:"GIOP"; depth:4; pcre:"/org\x2ecodehaus\x2egroovy\x2eruntime\x2e((Converted|Method)Closure|ConversionHandler)/im"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2020-2551;  sid:53449; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET 6129 (msg:"SERVER-OTHER Solarwinds Dameware Mini Remote Control agent access attempt"; flow:to_server,established; content:"|30 11 00 00 00 00 00 00 00 00 00 00 00 00 28 40 00 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2019-3980; reference:url,tenable.com/security/research/tra-2019-43;  sid:52236; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 5560 (msg:"SERVER-OTHER ZeroMQ libzmq stack-based buffer overflow attempt"; flow:to_server,established; content:"INITIATE"; isdataat:112,relative; content:!"CurveZMQINITIATE"; within:112; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:bugtraq,109284; reference:cve,2019-13132;  sid:52037; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER ASP webshell upload attempt"; flow:to_server,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; depth:8; content:"<%"; distance:0; content:"language"; within:25; nocase; content:"%>"; within:35; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1190/;  sid:49460; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Perl webshell upload attempt"; flow:to_server,established; file_data; content:"|FF D8 FF|"; depth:3; content:"/usr/bin/perl"; distance:0; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1190/;  sid:49459; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER PHP webshell upload attempt"; flow:to_server,established; file_data; content:"|FF D8 FF|"; depth:3; content:"<?php"; distance:0; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1190/;  sid:49458; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER PHP webshell upload attempt"; flow:to_server,established; file_data; content:"GIF8"; depth:4; content:"a"; within:1; distance:1; content:"<?php"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1190/;  sid:49457; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER PHP webshell upload attempt"; flow:to_server,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; depth:8; content:"<?php"; distance:0; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1190/;  sid:49456; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Perl webshell upload attempt"; flow:to_server,established; file_data; content:"GIF8"; depth:4; content:"a"; within:1; distance:1; content:"/usr/bin/perl"; distance:0; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1190/;  sid:49455; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER CFM webshell upload attempt"; flow:to_server,established; file_data; content:"|FF D8 FF|"; depth:3; content:"cfexecute"; distance:0; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1190/;  sid:49454; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER CFM webshell upload attempt"; flow:to_server,established; file_data; content:"GIF8"; depth:4; content:"a"; within:1; distance:1; content:"cfexecute"; distance:0; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1190/;  sid:49453; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Perl webshell upload attempt"; flow:to_server,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; depth:8; content:"/usr/bin/perl"; distance:0; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1190/;  sid:49452; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER ASP webshell upload attempt"; flow:to_server,established; file_data; content:"|FF D8 FF|"; depth:3; content:"<%"; distance:0; content:"language"; within:25; nocase; content:"%>"; within:35; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1190/;  sid:49451; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER CFM webshell upload attempt"; flow:to_server,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; depth:8; content:"cfexecute"; distance:0; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1190/;  sid:49450; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER ASP webshell upload attempt"; flow:to_server,established; file_data; content:"GIF8"; depth:4; content:"a"; within:1; distance:1; content:"<%"; distance:0; content:"language"; within:25; nocase; content:"%>"; within:35; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1190/;  sid:49449; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic remote code execution attempt"; flow:to_server,established; content:"|AC ED 00 05|"; content:".AbstractPlatformTransactionManager"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service java_rmi; reference:cve,2018-3191; reference:url,oracle.com/technetwork/security-advisory/cpuoct2018-4428296.html;  sid:48483; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic remote code execution attempt"; flow:to_server,established; content:"|AC ED 00 05|"; content:"|00 0B|us-l-breens|A5|<|AF F1 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service java_rmi; reference:cve,2018-3191; reference:url,oracle.com/technetwork/security-advisory/cpuoct2018-4428296.html;  sid:48482; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic remote code execution attempt"; flow:to_server,established; content:"|AC ED 00 05|"; content:"java.rmi.server.RemoteObject"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service java_rmi; reference:cve,2018-3191; reference:url,oracle.com/technetwork/security-advisory/cpuoct2018-4428296.html;  sid:48481; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3306 (msg:"SERVER-OTHER Oracle MySQL uninitialized variable remote code execution attempt"; flow:to_server,established; content:"extractvalue"; nocase; content:"number"; within:20; pcre:"/extractvalue.*?number\s*\x28\s*\x29/i"; metadata:policy max-detect-ips drop, service mysql;  sid:48221; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Spring Data Commons remote code execution attempt"; flow:to_server,established; content:"[#this.getClass().forName("; fast_pattern:only; content:".getRuntime().exec"; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-1273;  sid:46473; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 5432 (msg:"SERVER-OTHER PostgreSQL Empty Password authentication bypass attempt"; flow:to_server,established; content:"|70 00 00 00 05 00|"; depth:6; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service postgresql; reference:cve,2017-7546;  sid:46449; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle Weblogic unsafe deserialization remote code execution attempt detected"; flow:to_server,established; content:"|AC ED 00 05|"; content:"java.rmi.registry.Registry"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service java_rmi; reference:cve,2018-2628; reference:cve,2018-2893; reference:cve,2018-3245; reference:url,www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html; reference:url,www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html;  sid:46446; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"SERVER-OTHER Oracle WebLogic unsafe deserialization remote code execution attempt detected"; flow:to_server,established; content:"|AC ED 00 05|"; content:"InvocationHandler"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service java_rmi; reference:cve,2018-2628; reference:cve,2018-2893; reference:cve,2018-3245; reference:cve,2019-2890; reference:url,www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html; reference:url,www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html;  sid:46445; rev:4;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER PHP Exception Handling remote denial of service attempt"; flow:to_server,established; content:"O"; http_client_body; content:"exception"; nocase; http_client_body; content:"Exception"; nocase; http_client_body; content:"previous"; nocase; http_client_body; pcre:"/O(\x3a|%3a)\d+(\x3a|%3a).*exception.*(\x3a|%3a)\d(\x3a|%3a)(\x7b|%7b)S(\x3a|%3a)\d+(\x3a|%3a).*Exception.*previous.*(\x3b|%3b)r(\x3a|%3a)\d+(\x3b\x7d|%3b%7d)/Psim"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-7478;  sid:41690; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER PHP Exception Handling remote denial of service attempt"; flow:to_server,established; content:"O:"; http_uri; content:"exception"; nocase; http_uri; content:"Exception"; within:50; nocase; http_uri; content:"previous"; within:20; nocase; http_uri; pcre:"/O:\d+:.*exception.*:\d:\x7bS:\d+:.*Exception.*previous.*\x3br:\d+\x3b\x7d/iU"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-7478;  sid:41689; rev:2;)


alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SERVER-OTHER Trend Micro local node.js http command execution attempt"; flow:to_client,established; file_data; content:"/api/openUrlInDefaultBrowser"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,code.google.com/p/google-security-research/issues/detail?id=693;  sid:37287; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SERVER-OTHER Trend Micro local node.js http command execution attempt"; flow:to_client,established; file_data; content:":49155/api/"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,code.google.com/p/google-security-research/issues/detail?id=693;  sid:37286; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SERVER-OTHER Trend Micro local node.js http command execution attempt"; flow:to_client,established; file_data; content:"/api/showSB"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,code.google.com/p/google-security-research/issues/detail?id=693;  sid:37285; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [22,23] (msg:"SERVER-OTHER Juniper ScreenOS unauthorized backdoor access attempt"; flow:to_server,established; content:"<<< %s(un=|27|%s|27|) = %u"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ssh, service telnet; reference:cve,2015-7755; reference:url,kb.juniper.net/InfoCenter/index?page=content&id=JSA10713&cat=SIRT_1&actp=LIST;  sid:37146; rev:4;)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"SERVER-OTHER Oracle Java RMI remote code execution attempt"; flow:to_server,established; content:"|50 AC ED|"; depth:3; content:"type=MLet"; nocase; content:"getMBeansFromURL"; fast_pattern:only; content:"http"; nocase; content:"|3A 2F 2F|"; within:4; metadata:policy max-detect-ips drop, policy security-ips drop, service java_rmi; reference:cve,2015-2342; reference:cve,2020-11998; reference:url,7elements.co.uk/resources/blog/cve-2015-2342-remote-code-execution-within-vmware-vcenter; reference:url,activemq.apache.org/security-advisories.data/CVE-2020-11998-announcement.txt;  sid:36532; rev:3;)


alert tcp $EXTERNAL_NET any -> $HOME_NET 1234 (msg:"SERVER-OTHER multiple products WinExec function remote code execution attempt"; flow:to_server,established; content:"|00|W|00|i|00|n|00|E|00|x|00|e|00|c|00|(|00|"; fast_pattern:only; metadata:policy max-detect-ips drop; reference:cve,2015-7374; reference:url,automationdirect.com; reference:url,schneider-electric.com/ww/en/download/document/SEVD-2015-251-01;  sid:36454; rev:3;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER PHP unserialize and __wakeup use after free attempt"; flow:to_server,established; file_data; content:"<?php"; content:"class"; distance:0; content:"function"; within:200; content:"__wakeup"; within:50; fast_pattern; content:"unset|28|"; within:50; content:"unserialize|28|"; distance:0; metadata:policy max-detect-ips drop, service http; reference:cve,2015-2787;  sid:34054; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SERVER-OTHER PHP unserialize and __wakeup use after free attempt"; flow:to_client,established; file_data; content:"<?php"; content:"class"; distance:0; content:"function"; within:200; content:"__wakeup"; within:50; fast_pattern; content:"unset|28|"; within:50; content:"unserialize|28|"; distance:0; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-2787;  sid:34053; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER PHP 4 unserialize ZVAL Reference Counter Overflow attempt"; flow:to_server,established; isdataat:4800; content:"Cookie:"; isdataat:3600,relative; content:!"|0D 0A|"; within:3600; metadata:policy max-detect-ips drop, service http; reference:cve,2007-1286;  sid:34027; rev:3;)


alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|18 03 03|"; byte_jump:2,0,relative; content:"|18 03 03|"; within:3; byte_test:2,>,128,0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30788; rev:5;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|18 03 02|"; byte_jump:2,0,relative; content:"|18 03 02|"; within:3; byte_test:2,>,128,0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30787; rev:5;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|18 03 01|"; byte_jump:2,0,relative; content:"|18 03 01|"; within:3; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30786; rev:4;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|18 03 00|"; byte_jump:2,0,relative; content:"|18 03 00|"; within:3; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30785; rev:4;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|17 03 03|"; byte_jump:2,0,relative; content:"|18 03 03|"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30784; rev:4;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|16 03 03|"; byte_jump:2,0,relative; content:"|18 03 03|"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30783; rev:4;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|17 03 02|"; byte_jump:2,0,relative; content:"|18 03 02|"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30782; rev:4;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|16 03 02|"; byte_jump:2,0,relative; content:"|18 03 02|"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30781; rev:5;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|17 03 01|"; byte_jump:2,0,relative; content:"|18 03 01|"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30780; rev:4;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|16 03 01|"; byte_jump:2,0,relative; content:"|18 03 01|"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30779; rev:4;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|17 03 00|"; byte_jump:2,0,relative; content:"|18 03 00|"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30778; rev:4;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|16 03 00|"; byte_jump:2,0,relative; content:"|18 03 00|"; within:3; fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30777; rev:4;)

alert udp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|"; depth:1; offset:9; content:"|18 03 03|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30742; rev:2;)
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|"; depth:1; offset:37; content:"|18 03 03|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30741; rev:3;)
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|"; depth:1; offset:9; content:"|18 03 02|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30740; rev:2;)
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|"; depth:1; offset:37; content:"|18 03 02|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30739; rev:3;)
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|"; depth:1; offset:9; content:"|18 03 01|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30738; rev:2;)
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|"; depth:1; offset:37; content:"|18 03 01|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30737; rev:3;)
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|"; depth:1; offset:9; content:"|18 03 00|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30736; rev:2;)
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|"; depth:1; offset:37; content:"|18 03 00|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30735; rev:3;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|"; depth:1; offset:9; content:"|18 03 03|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30734; rev:4;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|"; depth:1; offset:37; content:"|18 03 03|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30733; rev:5;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|"; depth:1; offset:9; content:"|18 03 02|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30732; rev:4;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|"; depth:1; offset:37; content:"|18 03 02|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30731; rev:5;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|"; depth:1; offset:9; content:"|18 03 01|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30730; rev:4;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|"; depth:1; offset:37; content:"|18 03 01|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30729; rev:5;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|"; depth:1; offset:9; content:"|18 03 00|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30728; rev:4;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|"; depth:1; offset:37; content:"|18 03 00|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30727; rev:5;)
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|"; depth:1; offset:39; content:"|18 03 03|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30726; rev:4;)
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|"; depth:1; offset:11; content:"|18 03 03|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30725; rev:3;)
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|"; depth:1; offset:39; content:"|18 03 02|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30724; rev:4;)
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|"; depth:1; offset:11; content:"|18 03 02|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30723; rev:3;)
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|"; depth:1; offset:39; content:"|18 03 01|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30722; rev:4;)
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|"; depth:1; offset:11; content:"|18 03 01|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30721; rev:3;)
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|"; depth:1; offset:39; content:"|18 03 00|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30720; rev:4;)
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|"; depth:1; offset:11; content:"|18 03 00|"; within:3; distance:16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30719; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|"; depth:1; offset:39; content:"|18 03 03|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30718; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|"; depth:1; offset:11; content:"|18 03 03|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30717; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|"; depth:1; offset:39; content:"|18 03 02|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30716; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|"; depth:1; offset:11; content:"|18 03 02|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30715; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|"; depth:1; offset:39; content:"|18 03 01|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30714; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|"; depth:1; offset:11; content:"|18 03 01|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30713; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|"; depth:1; offset:39; content:"|18 03 00|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30712; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 (msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|"; depth:1; offset:11; content:"|18 03 00|"; within:3; distance:4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service openvpn; reference:cve,2014-0160;  sid:30711; rev:4;)

alert tcp $EXTERNAL_NET any -> $HOME_NET 443 (msg:"SERVER-OTHER OpenSSL Heartbleed masscan access exploitation attempt"; flow:to_server,established; content:"[masscan/1.0]"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30549; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] (msg:"SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server,established; isdataat:68; isdataat:!69; content:"|18 03 03 00 40|"; depth:5; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30525; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] (msg:"SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt"; flow:to_server,established; content:"|18 03 02 00 03 01 40 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30524; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] (msg:"SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt - vulnerable client response"; flow:to_server,established,only_stream; content:"|18 03 03|"; depth:3; byte_test:2,>,128,3; detection_filter:track by_dst, count 2, seconds 5; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30523; rev:9;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] (msg:"SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt - vulnerable client response"; flow:to_server,established,only_stream; content:"|18 03 02|"; depth:3; byte_test:2,>,128,3; detection_filter:track by_dst, count 2, seconds 5; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30522; rev:9;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] (msg:"SERVER-OTHER OpenSSL TLSv1 heartbeat read overrun attempt - vulnerable client response"; flow:to_server,established,only_stream; content:"|18 03 01|"; depth:3; byte_test:2,>,128,3; detection_filter:track by_dst, count 2, seconds 5; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30521; rev:9;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] (msg:"SERVER-OTHER OpenSSL SSLv3 heartbeat read overrun attempt - vulnerable client response"; flow:to_server,established,only_stream; content:"|18 03 00|"; depth:3; byte_test:2,>,128,3; detection_filter:track by_dst, count 2, seconds 5; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30520; rev:9;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established,only_stream; content:"|18 03 03|"; depth:3; byte_test:2,>,128,0,relative; content:"|02|"; within:1; distance:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30517; rev:11;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established,only_stream; content:"|18 03 02|"; depth:3; byte_test:2,>,128,0,relative; content:"|02|"; within:1; distance:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30516; rev:11;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established,only_stream; content:"|18 03 01|"; depth:3; byte_test:2,>,128,0,relative; content:"|02|"; within:1; distance:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30515; rev:11;)
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any (msg:"SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established,only_stream; content:"|18 03 00|"; depth:3; byte_test:2,>,128,0,relative; content:"|02|"; within:1; distance:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30514; rev:11;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] (msg:"SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server,established,only_stream; content:"|18 03 03|"; depth:3; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30513; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] (msg:"SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; content:"|18 03 02|"; depth:3; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30512; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] (msg:"SERVER-OTHER OpenSSL TLSv1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; content:"|18 03 01|"; depth:3; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30511; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] (msg:"SERVER-OTHER OpenSSL SSLv3 heartbeat read overrun attempt"; flow:to_server,established,only_stream; content:"|18 03 00|"; depth:3; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssl; reference:cve,2014-0160;  sid:30510; rev:8;)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"SERVER-OTHER Python socket.recvfrom_into remote buffer overflow attempt"; flow:to_server,established; content:"|08 59 38 08|"; depth:4; offset:4; content:"|08 59 38 08|"; within:4; distance:8; content:"|1C 59 38 08|"; within:250; metadata:policy max-detect-ips drop; reference:bugtraq,65379; reference:cve,2014-1912; reference:url,bugs.python.org/issue20246;  sid:29968; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"SERVER-OTHER Python socket.recvfrom_into remote buffer overflow attempt"; flow:to_server,established; content:"|08 79 AE B7|"; depth:4; offset:4; content:"|08 79 AE B7|"; within:4; distance:8; content:"|E0 B7 05 08|"; within:250; metadata:policy max-detect-ips drop; reference:bugtraq,65379; reference:cve,2014-1912; reference:url,bugs.python.org/issue20246;  sid:29967; rev:3;)


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Struts allowStaticMethodAccess invocation attempt"; flow:to_server,established; content:".do?"; nocase; http_uri; content:"allowStaticMethodAccess"; distance:0; nocase; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,60166; reference:cve,2013-1966; reference:cve,2013-2115; reference:url,struts.apache.org/development/2.x/docs/s2-014.html;  sid:26825; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Struts allowStaticMethodAccess invocation attempt"; flow:to_server,established; content:".action"; nocase; http_uri; content:"allowStaticMethodAccess"; nocase; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,60166; reference:cve,2013-1966; reference:cve,2013-2115; reference:url,struts.apache.org/development/2.x/docs/s2-014.html;  sid:26824; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Struts2 skillName remote code execution attempt"; flow:to_server,established; content:"edit.action?"; http_uri; content:"skillName=|7B 28 23|"; fast_pattern:only; http_uri; pcre:"/skillName\x3D\x7B\x28\x23/Ui"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,60082; reference:cve,2013-1965;  sid:26772; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 464 (msg:"SERVER-OTHER MIT Kerberos kpasswd process_chpw_request denial of service attempt"; flow:to_server,established; content:"|A1 03 02 01 05 A2 03 02 01|"; depth:9; offset:10; content:!"|FF 80|"; depth:2; offset:6; metadata:policy max-detect-ips drop; reference:bugtraq,47310; reference:cve,2011-0285; reference:url,attack.mitre.org/techniques/T1097; reference:url,web.mit.edu/kerberos/www/advisories/MITKRB5-SA-2011-004.txt;  sid:26769; rev:8;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 88 (msg:"SERVER-OTHER MIT Kerberos libkdb_ldap principal name handling denial of service attempt"; flow:to_server,no_stream; content:"|A1 03 02 01 05 A2|"; depth:12; content:"|1B|"; within:50; pcre:"/[^\xa2\x1b]+?[*()\x5c#\x22+,\x3b<>]/R"; detection_filter:track by_src, count 25, seconds 5; metadata:policy max-detect-ips drop, service kerberos; reference:bugtraq,46265; reference:bugtraq,46271; reference:cve,2011-0281; reference:cve,2011-0282; reference:url,attack.mitre.org/techniques/T1097; reference:url,web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-002.txt;  sid:26759; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 443 (msg:"SERVER-OTHER SSL TLS deflate compression weakness brute force attempt"; flow:to_server,established,no_stream; flowbits:isset,tls.deflate; isdataat:0; isdataat:!1000; detection_filter:track by_src,count 500,seconds 1; metadata:policy max-detect-ips drop, service ssl; reference:bugtraq,55704; reference:cve,2012-4929; reference:url,attack.mitre.org/techniques/T1110;  sid:26645; rev:7;)
alert tcp $HOME_NET 443 -> $EXTERNAL_NET any (msg:"SERVER-OTHER SSL TLS DEFLATE compression detected"; flow:to_client,established; ssl_state:server_hello; ssl_version:tls1.0,tls1.1; content:"|16 03|"; depth:2; byte_test:1,&,1,78; flowbits:set,tls.deflate; flowbits:noalert; metadata:policy max-detect-ips alert, service ssl;  sid:26644; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Adobe ColdFusion adminapi information disclosure attempt"; flow:to_server,established; content:"/CFIDE/adminapi/customtags/l10n.cfm"; fast_pattern; nocase; http_uri; content:"../"; distance:0; http_uri; metadata:policy max-detect-ips drop, service http; reference:bugtraq,59773; reference:cve,2013-3336; reference:url,www.adobe.com/support/security/advisories/apsa13-03.html;  sid:26621; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 5432 (msg:"SERVER-OTHER PostgreSQL database name command line injection attempt"; flow:to_server,established; content:"user|00|"; depth:5; offset:8; content:"database|00|-"; within:70; pcre:"/^.{8}user\x00[^\x00]+?\x00database\x00-[^\x00]+?\x00/"; metadata:policy max-detect-ips drop, service http; reference:cve,2013-1899; reference:url,www.postgresql.org/support/security/faq/2013-04-04/;  sid:26586; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SERVER-OTHER Autonomy Ultraseek cs.html url parameter with url - possible malicious redirection attempt"; flow:to_server,established; content:"/cs.html?url=http://"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0347;  sid:26542; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 6661 (msg:"SERVER-OTHER BigAnt Document Service DDNF request stack buffer overflow attempt"; flow:to_server,established; content:"cmdid: "; fast_pattern:only; content:"DDNF"; depth:4; content:"username: "; distance:0; nocase; isdataat:1024,relative; content:!"|0A|"; within:1024; metadata:policy max-detect-ips drop;  sid:26501; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 5666 (msg:"SERVER-OTHER Nagios NRPE command execution attempt"; flow:to_server,established; content:"|00 02 00 01|"; depth:4; content:"$("; within:20; distance:6; metadata:policy max-detect-ips drop; reference:bugtraq,58142; reference:cve,2013-1362;  sid:26491; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"SERVER-OTHER ActFax LPD Server data field buffer overflow attempt"; flow:to_server,established; content:"@F"; content:!"@"; within:254; pcre:"/@F\d{3}[^@\x00]{251}/"; metadata:policy max-detect-ips drop, service printer; reference:bugtraq,57789;  sid:26479; rev:6;)
# alert tcp $EXTERNAL_NET 5900 -> $HOME_NET any (msg:"SERVER-OTHER UltraVNC Listening mode stack buffer overflow attempt"; flow:to_client,established; content:"RFB 0"; depth:5; content:".016|0A|"; within:5; distance:2; isdataat:1100,relative; content:!"|00|"; within:1100; distance:2; metadata:policy max-detect-ips drop, service vnc-server; reference:cve,2008-0610;  sid:26455; rev:3;)
# alert tcp $EXTERNAL_NET 5900 -> $HOME_NET any (msg:"SERVER-OTHER UltraVNC Listening mode stack buffer overflow attempt"; flow:to_client,established; content:"RFB 0"; depth:5; content:".014|0A|"; within:5; distance:2; isdataat:1100,relative; content:!"|00|"; within:1100; distance:2; metadata:policy max-detect-ips drop, service vnc-server; reference:cve,2008-0610;  sid:26454; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 19810 (msg:"SERVER-OTHER Bopup Communications server buffer overflow attempt"; flow:to_server,established; content:"|01 00 00 00|"; depth:4; isdataat:300,relative; metadata:policy max-detect-ips drop, policy security-ips drop; reference:bugtraq,43836; reference:cve,2009-2227;  sid:26394; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 6661 (msg:"SERVER-OTHER BigAnt Document Service DUPF command arbitrary file upload attempt"; flow:to_server,established; content:"cmdid: "; fast_pattern:only; content:"DUPF"; depth:4; content:"filename:"; distance:0; nocase; content:"/../"; distance:0; metadata:policy max-detect-ips drop; reference:bugtraq,57214; reference:cve,2012-6274;  sid:26390; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 6661 (msg:"SERVER-OTHER BigAnt Document Service DUPF command arbitrary file upload attempt"; flow:to_server,established; content:"cmdid: "; fast_pattern:only; content:"DUPF"; depth:4; content:"filename:"; distance:0; nocase; content:"|5C|..|5C|"; distance:0; metadata:policy max-detect-ips drop; reference:bugtraq,57214; reference:cve,2012-6274;  sid:26389; rev:5;)
# alert tcp any any -> $HOME_NET 23 (msg:"SERVER-OTHER Polycom HDX authorization bypass attempt"; flow:to_server,established; content:"setenv othbootargs |22|devboot=bogus|22|"; fast_pattern:only; metadata:policy max-detect-ips drop, service telnet; reference:bugtraq,58523;  sid:26386; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Squid proxy Accept-Language denial of service attempt"; flow:to_server,established; content:"Accept-Language|3A 20 2C|"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, service http; reference:bugtraq,58316; reference:cve,2013-1839;  sid:26379; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [13838] (msg:"SERVER-OTHER HP LeftHand Virtual SAN hydra snmp request buffer overflow attempt"; flow:to_server,established; content:"set|3A|/lhn/public/network/snmp/traps/testTrap"; fast_pattern:only; byte_test:4,>,1066,8; metadata:policy max-detect-ips drop, policy security-ips drop; reference:cve,2012-3284; reference:url,h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c03661318;  sid:26336; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [13838] (msg:"SERVER-OTHER HP LeftHand Virtual SAN hydra diag request buffer overflow attempt"; flow:to_server,established; content:"set|3A|/lhn/public/system/diag/getListSupportTest/"; fast_pattern:only; byte_test:4,>=,4143,8; metadata:policy max-detect-ips drop, policy security-ips drop; reference:cve,2012-3283; reference:url,h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c03661318;  sid:26334; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [13838] (msg:"SERVER-OTHER HP LeftHand Virtual SAN hydra diag request buffer overflow attempt"; flow:to_server,established; content:"set|3A|/lhn/public/system/diag/getListSafeTest/"; fast_pattern:only; byte_test:4,>=,4140,8; metadata:policy max-detect-ips drop, policy security-ips drop; reference:cve,2012-3283; reference:url,h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c03661318;  sid:26333; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Coppermine Photo Gallery picEditor.php command execution attempt"; flow:to_server,established; content:"picEditor.php"; fast_pattern:only; http_uri; content:"POST"; http_method; content:"clipval="; http_client_body; content:"newimage="; http_client_body; content:"../"; distance:0; http_client_body; metadata:policy max-detect-ips drop, service http; reference:cve,2008-0506;  sid:26316; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Coppermine Photo Gallery picEditor.php command execution attempt"; flow:to_server,established; content:"picEditor.php"; fast_pattern:only; http_uri; content:"POST"; http_method; content:"quality="; http_client_body; content:"newimage="; http_client_body; content:"../"; distance:0; http_client_body; metadata:policy max-detect-ips drop, service http; reference:cve,2008-0506;  sid:26315; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Coppermine Photo Gallery picEditor.php command execution attempt"; flow:to_server,established; content:"picEditor.php"; fast_pattern:only; http_uri; content:"POST"; http_method; content:"angle="; http_client_body; content:"newimage="; http_client_body; content:"../"; distance:0; http_client_body; metadata:policy max-detect-ips drop, service http; reference:cve,2008-0506;  sid:26314; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 27017 (msg:"SERVER-OTHER MongoDB nativeHelper.apply method command injection attempt"; flow:to_server,established; content:"nativeHelper.apply("; fast_pattern:only; pcre:"/nativeHelper\.apply\(\s*?\{\s*?[\x22\x27]\s*?x\s*?[\x22\x27]\s*?:\s*?(0x)?\d/i"; metadata:policy max-detect-ips drop; reference:bugtraq,58695; reference:cve,2013-1892;  sid:26262; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 998 (msg:"SERVER-OTHER Novell ZENworks Configuration Management Preboot service code overflow attempt"; flow:to_server,established; content:"|00 00 00 21|"; depth:4; byte_test:4,>,0x200,0,relative,big; metadata:policy max-detect-ips drop; reference:bugtraq,40486;  sid:26180; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 2207 (msg:"SERVER-OTHER HP Linux Imaging and Printing Project hpssd daemon command injection attempt"; flow:to_server,established; content:"email-to-address"; nocase; content:"&"; distance:0; pcre:"/^email-to-address(es)?=[^\r\n]*?[\x3b\x26]/mi"; metadata:policy max-detect-ips drop; reference:bugtraq,26054; reference:cve,2007-5208;  sid:26108; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 2207 (msg:"SERVER-OTHER HP Linux Imaging and Printing Project hpssd daemon command injection attempt"; flow:to_server,established; content:"email-from-address="; nocase; content:"&"; distance:0; pcre:"/^email-from-address=[^\r\n]*?[\x3b\x26]/mi"; metadata:policy max-detect-ips drop; reference:bugtraq,26054; reference:cve,2007-5208;  sid:26107; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 6661 (msg:"SERVER-OTHER BigAnt IM Server buffer overflow attempt"; flow:to_server,established; content:"source_cmdname|3A| DUPF"; content:"username|3A| "; distance:0; isdataat:574,relative; content:!"|0A|"; within:574; metadata:policy max-detect-ips drop, policy security-ips drop; reference:bugtraq,57214; reference:cve,2012-6275;  sid:26105; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [13838] (msg:"SERVER-OTHER HP LeftHand Virtual SAN hydra ping request buffer overflow attempt"; flow:to_server,established; content:"get|3A|/lhn/public/network/ping/"; nocase; content:"/"; distance:0; isdataat:1048,relative; content:!"/"; within:1048; metadata:policy max-detect-ips drop, policy security-ips drop; reference:cve,2012-3285; reference:url,h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c03661318;  sid:26103; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [3600:3699,3900:3999] (msg:"SERVER-OTHER SAP NetWeaver Message Server buffer overflow attempt"; flow:to_server,established; content:"**MESSAGE**|00|"; depth:12; offset:4; content:"|05|"; within:1; distance:55; content:"AD-EYECATCH|00|"; within:12; distance:42; content:"|15|"; within:1; distance:24; byte_test:1,>,78,6,relative; metadata:policy max-detect-ips drop; reference:cve,2013-1593; reference:url,service.sap.com/sap/support/notes/1800603;  sid:26074; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [3600:3699,3900:3999] (msg:"SERVER-OTHER SAP NetWeaver Message Server buffer overflow attempt"; flow:to_server,established; content:"**MESSAGE**|00|"; depth:12; offset:4; byte_test:1,>=,0x0c,55,relative; byte_test:1,<=,0x0d,55,relative; byte_test:4,>,256,106,relative; metadata:policy max-detect-ips drop; reference:cve,2013-1592; reference:url,service.sap.com/sap/support/notes/1800603;  sid:26073; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"SERVER-OTHER SSLv3 plaintext recovery attempt"; flow:to_client,established,only_stream; isdataat:53; isdataat:!54; ssl_version:sslv3; content:"|15 03 00 00 30|"; depth:5; detection_filter:track by_dst, count 100, seconds 5; metadata:policy max-detect-ips drop, service ssl; reference:cve,2013-0169;  sid:25828; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"SERVER-OTHER TLSv1.2 plaintext recovery attempt"; flow:to_client,established,only_stream; isdataat:53; isdataat:!54; ssl_version:tls1.2; content:"|15 03 03 00 30|"; depth:5; detection_filter:track by_dst, count 100, seconds 5; metadata:policy max-detect-ips drop, service ssl; reference:cve,2013-0169;  sid:25827; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"SERVER-OTHER TLSv1.1 plaintext recovery attempt"; flow:to_client,established,only_stream; isdataat:53; isdataat:!54; ssl_version:tls1.1; content:"|15 03 02 00 30|"; depth:5; detection_filter:track by_dst, count 100, seconds 5; metadata:policy max-detect-ips drop, service ssl; reference:cve,2013-0169;  sid:25826; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"SERVER-OTHER TLSv1.0 plaintext recovery attempt"; flow:to_client,established,only_stream; isdataat:53; isdataat:!54; ssl_version:tls1.0; content:"|15 03 01 00 30|"; depth:5; detection_filter:track by_dst, count 100, seconds 5; metadata:policy max-detect-ips drop, service ssl; reference:cve,2013-0169;  sid:25825; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,5555] (msg:"SERVER-OTHER MiniUPnPd ExecuteSoapAction buffer overflow attempt"; flow:to_server,established; content:"SOAPAction|3A|"; fast_pattern:only; http_header; pcre:"/SOAPAction\x3A\s*?\x22[^\x22\x23]+?\x23([^\x22]{2048}|[^\x22]+$)/Hsi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2013-0230; reference:cve,2013-1462;  sid:25780; rev:5;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"SERVER-OTHER MiniUPnPd SSDP request buffer overflow attempt"; flow:to_server; content:"M-SEARCH "; depth:9; content:"ST|3A|"; content:!"|0D|"; within:512; content:!"|0A|"; within:512; metadata:policy max-detect-ips drop, service ssdp; reference:cve,2013-0229; reference:cve,2013-2600;  sid:25664; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 19813 (msg:"SERVER-OTHER HP Data Protector Media Operations directory traversal attempt"; flow:to_client,established; content:"|10|"; content:!"|00 00 00 00|"; within:4; distance:3; content:"|10 00 00 00|"; within:4; distance:11; content:".."; within:50; metadata:policy max-detect-ips drop; reference:bugtraq,50531;  sid:25658; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 19813 (msg:"SERVER-OTHER HP Data Protector Media Operations directory traversal attempt"; flow:to_server,established; content:"|03|"; content:!"|00 00 00 00|"; within:4; distance:3; content:"|10 00 00 00|"; within:4; distance:11; content:".."; within:50; metadata:policy max-detect-ips drop; reference:bugtraq,50531;  sid:25657; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 5555 (msg:"SERVER-OTHER HP OpenView Storage Data Protector exec_cmd buffer overflow attempt"; flow:to_server,established; content:"|FE FF|"; depth:2; offset:4; content:"|32 00|"; distance:0; content:"|32 00 30 00|"; distance:0; isdataat:2046,relative; content:!"|00 00 00 00|"; within:2046; metadata:policy max-detect-ips drop, policy security-ips drop; reference:bugtraq,48488; reference:cve,2011-1866;  sid:25656; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 5555 (msg:"SERVER-OTHER HP OpenView Storage Data Protector exec_cmd buffer overflow attempt"; flow:to_server,established; content:"|FF FE|"; depth:2; offset:4; content:"|32 00|"; content:"|32 30 00|"; distance:0; isdataat:2046,relative; content:!"|00 00|"; within:2046; metadata:policy max-detect-ips drop, policy security-ips drop; reference:bugtraq,48488; reference:cve,2011-1866;  sid:25655; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 5555 (msg:"SERVER-OTHER HP OpenView Storage Data Protector exec_cmd buffer overflow attempt"; flow:to_server,established; content:!"|FF FE|"; depth:2; offset:4; content:!"|FE FF|"; depth:2; offset:4; content:"|32 00|"; content:"|32 30 00|"; distance:0; isdataat:1023,relative; content:!"|00 00|"; within:1023; metadata:policy max-detect-ips drop, policy security-ips drop; reference:bugtraq,48488; reference:cve,2011-1866;  sid:25654; rev:6;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"SERVER-OTHER libupnp command buffer overflow attempt"; flow:to_server; content:"M-SEARCH "; depth:9; content:"ST|3A|uuid|3A|"; fast_pattern:only; content:"uuid|3A|"; isdataat:190,relative; content:!"|3A 3A|"; within:190; metadata:policy max-detect-ips drop, policy security-ips drop, service ssdp; reference:cve,2012-5959;  sid:25620; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"SERVER-OTHER libupnp command buffer overflow attempt"; flow:to_server; content:"M-SEARCH "; depth:9; content:"ST|3A|uuid|3A|"; fast_pattern:only; content:"uuid|3A|"; isdataat:190,relative; content:!"|0D|"; within:190; metadata:policy max-detect-ips drop, policy security-ips drop, service ssdp; reference:cve,2012-5963;  sid:25619; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"SERVER-OTHER libupnp command buffer overflow attempt"; flow:to_server; content:"M-SEARCH "; depth:9; content:"|3A|service|3A|"; fast_pattern:only; content:"ST|3A|urn|3A|"; isdataat:190,relative; content:!"|0D|"; within:190; metadata:policy max-detect-ips drop, policy security-ips drop, service ssdp; reference:cve,2012-5964;  sid:25618; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"SERVER-OTHER libupnp command buffer overflow attempt"; flow:to_server; content:"M-SEARCH "; depth:9; content:"|3A|device|3A|"; fast_pattern:only; content:"ST|3A|urn|3A|"; isdataat:190,relative; content:!"|0D|"; within:190; metadata:policy max-detect-ips drop, policy security-ips drop, service ssdp; reference:cve,2012-5965;  sid:25617; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"SERVER-OTHER libupnp command buffer overflow attempt"; flow:to_server; content:"M-SEARCH "; depth:9; content:"ST|3A|"; content:!"|3A 3A|upnp|3A|rootdevice"; within:200; content:"|3A 3A|upnp|3A|rootdevice"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ssdp; reference:cve,2012-5960;  sid:25612; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [5001,5002] (msg:"SERVER-OTHER Sybase Open Server TDS login packet stack memory corruption attempt"; flow:to_server,established; flowbits:isset,sybase.tds.connection; content:"|02 01|"; depth:2; content:"|00 00 00 00|"; within:4; distance:2; byte_test:1,>,6,59,relative; metadata:policy max-detect-ips drop; reference:url,www.sybase.com/detail?id=1094235;  sid:25603; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [5001,5002] (msg:"SERVER-OTHER Sybase Open Server TDS login request"; flow:to_server,established; content:"|02 00 02 00 00 00 00 00|"; depth:8; content:"|06 04 08|"; within:3; distance:126; content:"DBISQL"; within:6; distance:11; content:"jConnect"; within:8; distance:316; fast_pattern; flowbits:set,sybase.tds.connection; flowbits:noalert; metadata:policy max-detect-ips alert; reference:url,en.wikipedia.org/wiki/Tabular_Data_Stream;  sid:25602; rev:7;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"SERVER-OTHER libupnp command buffer overflow attempt"; flow:to_server; content:"M-SEARCH "; depth:9; content:"ST|3A|uuid|3A|schemas|3A|device|3A|"; content:"|3A|"; within:20; isdataat:200,relative; content:!"|0D|"; within:200; metadata:policy max-detect-ips drop, policy security-ips drop, service ssdp; reference:cve,2012-5961;  sid:25601; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"SERVER-OTHER libupnp command buffer overflow attempt"; flow:to_server; content:"M-SEARCH "; depth:9; content:"|3A|device|3A|"; isdataat:180,relative; content:!"|3A|"; within:180; metadata:policy max-detect-ips drop, policy security-ips drop, ruleset community, service ssdp; reference:cve,2012-5958; reference:cve,2012-5962;  sid:25589; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3000 (msg:"SERVER-OTHER EMC AlphaStor Device Manager command injection attempt"; flow:to_server,established; content:"|75|"; depth:1; content:"nsrmm"; distance:0; pcre:"/nsrmm[^\x00]*?([\x3b\x7c\x26\x60]|\x24\x28)/"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:bugtraq,57472; reference:cve,2013-0928;  sid:25585; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3000 (msg:"SERVER-OTHER EMC AlphaStor Device Manager command injection attempt"; flow:to_server,established; content:"|75|"; depth:1; content:"mmpool"; distance:0; pcre:"/mmpool[^\x00]*?([\x3b\x7c\x26\x60]|\x24\x28)/"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:bugtraq,57472; reference:cve,2013-0928;  sid:25584; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3000 (msg:"SERVER-OTHER EMC AlphaStor Device Manager command injection attempt"; flow:to_server,established; content:"|75|"; depth:1; content:"mmlocate"; distance:0; pcre:"/mmlocate[^\x00]*?([\x3b\x7c\x26\x60]|\x24\x28)/"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:bugtraq,57472; reference:cve,2013-0928;  sid:25583; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3000 (msg:"SERVER-OTHER EMC AlphaStor Device Manager command injection attempt"; flow:to_server,established; content:"|75|"; depth:1; content:"mminfo"; distance:0; pcre:"/mminfo[^\x00]*?([\x3b\x7c\x26\x60]|\x24\x28)/"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:bugtraq,57472; reference:cve,2013-0928;  sid:25582; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3000 (msg:"SERVER-OTHER EMC AlphaStor Device Manager command injection attempt"; flow:to_server,established; content:"|75|"; depth:1; content:"nsrjb"; distance:0; pcre:"/nsrjb[^\x00]*?([\x3b\x7c\x26\x60]|\x24\x28)/"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:bugtraq,57472; reference:cve,2013-0928;  sid:25581; rev:6;)

alert tcp $EXTERNAL_NET any -> $HOME_NET 1099 (msg:"SERVER-OTHER Oracle Java RMI services remote object execution attempt"; flow:to_server,established; content:"|F6 B6 89 8D 8B F2 86 43|"; fast_pattern:only; content:"java.rmi.server"; content:"http|3A 2F 2F|"; nocase; metadata:policy max-detect-ips drop, service java_rmi; reference:cve,2015-2342; reference:url,www.exploit-db.com/exploits/17535;  sid:21268; rev:6;)

alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SERVER-OTHER Oracle Java Web Start BasicService arbitrary command execution attempt"; flow:to_client,established; file_data; content:"javax.jnlp.BasicService"; fast_pattern:only; content:"file|3A 5C 5C|"; nocase; content:"showDocument"; distance:0; metadata:policy max-detect-ips drop, service http; reference:cve,2008-4910;  sid:20249; rev:7;)

alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SERVER-OTHER banner.txt access - possible compromised multi-mesh injection server"; flow:to_server,established; content:"/banner.txt"; nocase; http_uri; flowbits:set,http.multimesh; flowbits:noalert; metadata:policy max-detect-ips alert, service http; reference:url,blog.armorize.com/2011/06/mass-meshing-injection-sidenamejs.html;  sid:19299; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SERVER-OTHER cssminibar.js script injection"; flow:to_server,established; content:"/cssminibar.js"; nocase; http_uri; flowbits:set,http.multimesh; metadata:policy max-detect-ips drop, service http; reference:url,blog.armorize.com/2011/06/mass-meshing-injection-sidenamejs.html;  sid:19298; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SERVER-OTHER sidename.js script injection"; flow:to_server,established; content:"/sidename.js"; nocase; http_uri; flowbits:set,http.multimesh; metadata:policy max-detect-ips drop, service http; reference:url,blog.armorize.com/2011/06/mass-meshing-injection-sidenamejs.html;  sid:19297; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"${upper:"; fast_pattern:only; http_client_body; pcre:"/\x24{(\x24{(upper|lower):j}|j)(\x24{(upper|lower):n}|n)(\x24{(upper|lower):d}|d)(\x24{(upper|lower):i}|i)(\x24{(upper|lower)::}|:)/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58733; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"upper"; fast_pattern:only; content:"upper"; nocase; http_cookie; pcre:"/(%(25)?24|\x24)(%(25)?7b|\x7b)upper(%(25)?3a|\x3a)/Ci"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf;  sid:58732; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"${upper:"; fast_pattern:only; http_header; pcre:"/\x24{(\x24{(upper|lower):j}|j)(\x24{(upper|lower):n}|n)(\x24{(upper|lower):d}|d)(\x24{(upper|lower):i}|i)(\x24{(upper|lower)::}|:)/Hi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf;  sid:58731; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"lower"; fast_pattern:only; content:"lower"; nocase; http_cookie; pcre:"/(%(25)?24|\x24)(%(25)?7b|\x7b)lower(%(25)?3a|\x3a)/Ci"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf;  sid:58730; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"${upper:"; fast_pattern:only; http_uri; pcre:"/\x24{(\x24{(upper|lower):j}|j)(\x24{(upper|lower):n}|n)(\x24{(upper|lower):d}|d)(\x24{(upper|lower):i}|i)(\x24{(upper|lower)::}|:)/Ui"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58729; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"${lower:"; fast_pattern:only; http_client_body; pcre:"/\x24{(\x24{(upper|lower):j}|j)(\x24{(upper|lower):n}|n)(\x24{(upper|lower):d}|d)(\x24{(upper|lower):i}|i)(\x24{(upper|lower)::}|:)/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58728; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"${jndi:"; fast_pattern:only; http_client_body; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58727; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"jndi"; fast_pattern:only; content:"jndi"; nocase; http_cookie; pcre:"/(%(25)?24|\x24)(%(25)?7b|\x7b)jndi(%(25)?3a|\x3a)/Ci"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf;  sid:58726; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"${lower:"; fast_pattern:only; http_uri; pcre:"/\x24{(\x24{(upper|lower):j}|j)(\x24{(upper|lower):n}|n)(\x24{(upper|lower):d}|d)(\x24{(upper|lower):i}|i)(\x24{(upper|lower)::}|:)/Ui"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58725; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"${lower:"; fast_pattern:only; http_header; pcre:"/\x24{(\x24{(upper|lower):j}|j)(\x24{(upper|lower):n}|n)(\x24{(upper|lower):d}|d)(\x24{(upper|lower):i}|i)(\x24{(upper|lower)::}|:)/Hi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf;  sid:58724; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"${jndi:"; fast_pattern:only; http_header; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf;  sid:58723; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"${jndi:"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58722; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"lower"; fast_pattern:only; http_header; pcre:"/(%(25)?24|\x24)(%(25)?7b|\x7b)lower(%(25)?3a|\x3a)/Hi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf;  sid:58739; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"upper"; fast_pattern:only; http_header; pcre:"/(%(25)?24|\x24)(%(25)?7b|\x7b)upper(%(25)?3a|\x3a)/Hi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf;  sid:58738; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"jndi"; fast_pattern:only; http_header; pcre:"/(%(25)?24|\x24)(%(25)?7b|\x7b)jndi(%(25)?3a|\x3a)/Hi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf;  sid:58737; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"upper"; fast_pattern:only; http_client_body; pcre:"/(%(25)?24|\x24)(%(25)?7b|\x7b)upper(%(25)?3a|\x3a)/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58736; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"lower"; fast_pattern:only; http_client_body; pcre:"/(%(25)?24|\x24)(%(25)?7b|\x7b)lower(%(25)?3a|\x3a)/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58735; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"jndi"; fast_pattern:only; http_client_body; pcre:"/(%(25)?24|\x24)(%(25)?7b|\x7b)jndi(%(25)?3a|\x3a)/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58734; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"${"; fast_pattern:only; http_uri; pcre:"/\x24\x7b(jndi|[^\x7d\x80-\xff]*?\x24\x7b[^\x7d]*?\x3a[^\x7d]*?\x7d)/Ui"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58744; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"${"; fast_pattern:only; content:"${"; nocase; http_cookie; content:"|2F|"; http_uri; pcre:"/\x24\x7b(jndi|[^\x7d\x80-\xff]*?\x24\x7b[^\x7d]*?\x3a[^\x7d]*?\x7d)/Ci"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58743; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"${"; fast_pattern:only; http_header; content:"|2F|"; http_uri; pcre:"/\x24\x7b(jndi|[^\x7d\x80-\xff]*?\x24\x7b[^\x7d\x80-\xff]*?\x3a[^\x7d]*?\x7d)/Hi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:cve,2022-20933; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-meraki-mx-vpn-dos-vnESbgBf;  sid:58742; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"${"; fast_pattern:only; http_client_body; pcre:"/\x24\x7b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58741; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"%24%7b"; fast_pattern:only; http_client_body; pcre:"/%24%7b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58740; rev:6;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"%2524%7b"; fast_pattern:only; http_client_body; pcre:"/%2524%7b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58790; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"$%257b"; fast_pattern:only; http_client_body; pcre:"/\x24%257b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58789; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"$%7b"; fast_pattern:only; http_client_body; pcre:"/\x24%7b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58788; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"%24%257b"; fast_pattern:only; http_client_body; pcre:"/%24%257b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58787; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"%2524{"; fast_pattern:only; http_client_body; pcre:"/%2524\x7b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58786; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"%24{"; fast_pattern:only; http_client_body; pcre:"/%24\x7b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58785; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"%2524%257B"; fast_pattern:only; http_client_body; pcre:"/%2524%257b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/Pi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58784; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER Apache Log4j logging remote code execution attempt"; flow:to_server,established; content:"Authorization: Basic JH"; fast_pattern:only; http_header; content:"Authorization: Basic "; http_header; base64_decode:relative; base64_data; pcre:"/\x24\x7b(jndi|lower|upper|.{0,200}\x24\x7b.{0,200}\x3a[\x27\x22\x2d\x5c]*[jndi\x7d\x3a\x2d]{1,4}[\x22\x27]?[\x3a\x7djndi])/i"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58795; rev:4;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER VMWare vSphere log4shell exploit attempt"; flow:to_server,established; content:"/websso/SAML2/SSOSSL/"; nocase; http_uri; content:"RelyingPartyEntityId="; distance:0; fast_pattern; http_uri; base64_decode:bytes 64,relative; base64_data; pcre:"/\x24\x7b(jndi|[^\x7d]*?\x24\x7b[^\x7d]*?\x3a[^\x7d]*?\x7d)/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58813; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER VMWare vSphere log4shell exploit attempt"; flow:to_server,established; content:"Content-Disposition"; nocase; http_client_body; content:"RelyingPartyEntityId"; distance:0; nocase; http_client_body; content:"|0D 0A 0D 0A|"; distance:0; http_client_body; base64_decode:bytes 64,relative; base64_data; pcre:"/\x24\x7b(jndi|[^\x7d]*?\x24\x7b[^\x7d]*?\x3a[^\x7d]*?\x7d)/i"; content:"/websso/SAML2/SSOSSL/"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58812; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER VMWare vSphere log4shell exploit attempt"; flow:to_server,established; content:"/websso/SAML2/SSOSSL/"; nocase; http_uri; content:"RelyingPartyEntityId="; fast_pattern; nocase; http_client_body; base64_decode:bytes 64,relative; base64_data; pcre:"/\x24\x7b(jndi|[^\x7d]*?\x24\x7b[^\x7d]*?\x3a[^\x7d]*?\x7d)/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105;  sid:58811; rev:3;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER MongoDB mongo-express insecure document processing code execution attempt"; flow:to_server,established; content:"/checkValid"; nocase; http_uri; content:"require|28|"; nocase; http_client_body; content:"child_process"; fast_pattern:only; http_client_body; pcre:"/\x2e\s*require\x28\s*[\x22\x27]child_process[\x22\x27]\s*\x29\s*\x2e\s*(exec|fork|spawn)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-10758; reference:url,github.com/mongo-express/mongo-express/security/advisories/GHSA-h47j-hc6x-h3qq;  sid:58834; rev:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-OTHER lodash defaultsDeep prototype pollution attempt"; flow:to_server,established; content:"|7B||22|constructor|22|: |7B||22|prototype|22|:"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-10744; classtype:attempted-user; sid:54184; rev:1;)
